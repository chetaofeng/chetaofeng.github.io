<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">

<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
<style>
    .pace .pace-progress {
        background: #1E92FB; /*è¿›åº¦æ¡é¢œè‰²*/
        height: 3px;
    }
    .pace .pace-progress-inner {
         box-shadow: 0 0 10px #1E92FB, 0 0 5px     #1E92FB; /*é˜´å½±é¢œè‰²*/
    }
    .pace .pace-activity {
        border-top-color: #1E92FB;    /*ä¸Šè¾¹æ¡†é¢œè‰²*/
        border-left-color: #1E92FB;    /*å·¦è¾¹æ¡†é¢œè‰²*/
    }
</style>

<script>
    (function(){
        if(''){
            if (prompt('è¯·è¾“å…¥æ–‡ç« å¯†ç ') !== ''){
                alert('å¯†ç é”™è¯¯ï¼');
                history.back();
            }
        }
    })();
</script>








<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="è¡Œé”‹çš„æŠ€æœ¯åšå®¢">
<meta property="og:type" content="website">
<meta property="og:title" content="è¡Œé”‹">
<meta property="og:url" content="https://chetaofeng.github.io/index.html">
<meta property="og:site_name" content="è¡Œé”‹">
<meta property="og:description" content="è¡Œé”‹çš„æŠ€æœ¯åšå®¢">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="è¡Œé”‹">
<meta name="twitter:description" content="è¡Œé”‹çš„æŠ€æœ¯åšå®¢">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://chetaofeng.github.io/"/>





  <title>è¡Œé”‹</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <a href="https://github.com/chetaofeng"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png" alt="Fork me on GitHub"></a>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">è¡Œé”‹</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">ä½å¤´èµ°è·¯ï¼ŒæŠ¬å¤´æ€è€ƒ</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            å…³äº
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            æœç´¢
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="æœç´¢..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://chetaofeng.github.io/2019/02/21/ç¯å¢ƒæ­å»º-Javaç¨‹åºå¼€å‘å…¶ä»–é…ç½®/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è¡Œé”‹">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/pub-images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è¡Œé”‹">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/21/ç¯å¢ƒæ­å»º-Javaç¨‹åºå¼€å‘å…¶ä»–é…ç½®/" itemprop="url">Javaå¼€å‘å…¶ä»–é…ç½®</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-02-21T22:10:23+08:00">
                2019-02-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ç¯å¢ƒæ­å»º/" itemprop="url" rel="index">
                    <span itemprop="name">ç¯å¢ƒæ­å»º</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="mavené…ç½®"><a class="markdownIt-Anchor" href="#mavené…ç½®"></a> mavené…ç½®</h1>
<p>å®˜ç½‘ï¼š<a href="http://maven.apache.org/" target="_blank" rel="noopener">http://maven.apache.org/</a><br>
ä¸‹è½½ï¼š<a href="http://maven.apache.org/download.cgi" target="_blank" rel="noopener">http://maven.apache.org/download.cgi</a></p>
<ol>
<li>ä¸‹è½½è§£å‹å®‰è£…åŒ…:tar zvxf apache-maven-3.5.0-bin.tar.gz</li>
<li>é…ç½®mavenç¯å¢ƒå˜é‡:sudo vim /etc/profile,ç¼–è¾‘ç³»ç»Ÿé…ç½®æ–‡ä»¶</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#set Maven environment</span><br><span class="line">export MAVEN_HOME=/usr/local/software/dir-maven/apache-maven-3.5.0</span><br><span class="line">export PATH=$MAVEN_HOME/bin:$PATH</span><br></pre></td></tr></table></figure>
<p>source /etc/profile<br>
3. æ‰§è¡Œmvn -væŸ¥çœ‹æ˜¯å¦å®‰è£…å®Œæˆ</p>
<p>é…ç½®mavençš„é•œåƒä»“åº“</p>
<ul>
<li>åœ¨confç›®å½•ä¸­æ‰¾åˆ°settings.xml æ–‡ä»¶ï¼Œé…ç½®mirrorsçš„å­èŠ‚ç‚¹ï¼Œæ·»åŠ å¦‚ä¸‹mirror</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//é˜¿é‡Œäº‘Mavené•œåƒï¼š</span><br><span class="line">&lt;mirror&gt;  </span><br><span class="line">    &lt;id&gt;nexus-aliyun&lt;/id&gt;  </span><br><span class="line">    &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;    </span><br><span class="line">    &lt;name&gt;Nexus aliyun&lt;/name&gt;  </span><br><span class="line">    &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public&lt;/url&gt;  </span><br><span class="line">&lt;/mirror&gt;</span><br><span class="line">æˆ–å¼€æºä¸­å›½mavené•œåƒ</span><br><span class="line">&lt;mirror&gt;  </span><br><span class="line">  &lt;id&gt;nexus-osc&lt;/id&gt;  </span><br><span class="line">  &lt;mirrorOf&gt;*&lt;/mirrorOf&gt;  </span><br><span class="line">  &lt;name&gt;Nexus osc&lt;/name&gt;  </span><br><span class="line">  &lt;url&gt;http://maven.oschina.net/content/groups/public/&lt;/url&gt;  </span><br><span class="line">&lt;/mirror&gt;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    <div>
          
    </div>

    

    <div>
      
    </div>


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://chetaofeng.github.io/2019/02/20/Java-zookeeperå…¥é—¨/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è¡Œé”‹">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/pub-images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è¡Œé”‹">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/20/Java-zookeeperå…¥é—¨/" itemprop="url">zookeeperå…¥é—¨</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-02-20T21:25:33+08:00">
                2019-02-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="/pub-images/zookeeper.png" alt="image"></p>
<h1 id="ç®€ä»‹"><a class="markdownIt-Anchor" href="#ç®€ä»‹"></a> ç®€ä»‹</h1>
<ul>
<li>ä¸­é—´ä»¶ï¼Œæä¾›åè°ƒæœåŠ¡</li>
<li>ä½œç”¨äºåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œå‘æŒ¥å…¶ä¼˜åŠ¿ï¼Œå¯ä»¥ä¸ºå¤§æ•°æ®æœåŠ¡</li>
<li>æ”¯æŒjavaï¼Œæä¾›javaå’Œcè¯­è¨€å¯¹å®¢æˆ·ç«¯api</li>
</ul>
<p>zookeeper=æ–‡ä»¶ç³»ç»Ÿ+ç›‘å¬é€šçŸ¥æœºåˆ¶</p>
<h1 id="åˆ†å¸ƒå¼ç³»ç»Ÿ"><a class="markdownIt-Anchor" href="#åˆ†å¸ƒå¼ç³»ç»Ÿ"></a> åˆ†å¸ƒå¼ç³»ç»Ÿ</h1>
<ul>
<li>å¾ˆå¤šå°è®¡ç®—æœºç»„æˆä¸€ä¸ªæ•´ä½“ï¼Œä¸€ä¸ªæ•´ä½“ä¸€è‡´å¯¹å¤–å¹¶ä¸”å¤„ç†åŒä¸€è¯·æ±‚</li>
<li>å†…éƒ¨çš„æ¯å°è®¡ç®—æœºéƒ½å¯ä»¥ç›¸äº’é€šä¿¡ï¼ˆrestï¼rpcï¼‰</li>
<li>å®¢æˆ·ç«¯åˆ°æœåŠ¡ç«¯çš„ä¸€æ¬¡è¯·æ±‚åˆ°å“åº”ç»“æŸä¼šå†ç»å¤šå°è®¡ç®—æœº</li>
</ul>
<p>è‡ªè¡Œæœç´¢å›¾è§£</p>
<h1 id="åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç“¶é¢ˆ"><a class="markdownIt-Anchor" href="#åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç“¶é¢ˆ"></a> åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç“¶é¢ˆ</h1>
<h1 id="zookeeperçš„ç‰¹æ€§"><a class="markdownIt-Anchor" href="#zookeeperçš„ç‰¹æ€§"></a> zookeeperçš„ç‰¹æ€§</h1>
<ul>
<li>ä¸€è‡´æ€§ï¼šæ•°æ®ä¸€è‡´æ€§ï¼Œæ•°æ®æŒ‰é¡ºåºåˆ†æ‰¹å…¥åº“</li>
<li>åŸå­æ€§ï¼šäº‹ç‰©è¦ä¹ˆæˆåŠŸè¦ä¹ˆå¤±è´¥ï¼Œä¸ä¼šå±€éƒ¨åŒ–</li>
<li>å•ä¸€è§†å›¾ï¼šå®¢æˆ·ç«¯è¿æ¥é›†ç¾¤ä¸­ä»»ä¸€zkèŠ‚ç‚¹ï¼Œæ•°æ®éƒ½æ˜¯ä¸€è‡´çš„</li>
<li>å¯é æ€§ï¼šæ¯æ¬¡å¯¹zkçš„æ“ä½œçŠ¶æ€éƒ½ä¼šä¿å­˜åœ¨æœåŠ¡ç«¯</li>
<li>å®æ—¶æ€§ï¼šå®¢æˆ·ç«¯å¯ä»¥è¯»å–åˆ°zkæœåŠ¡ç«¯çš„æœ€æ–°æ•°æ®</li>
</ul>
<h1 id="å®‰è£…é…ç½®"><a class="markdownIt-Anchor" href="#å®‰è£…é…ç½®"></a> å®‰è£…é…ç½®</h1>
<p>å®˜ç½‘ï¼š <a href="http://zookeeper.apache.org/" target="_blank" rel="noopener">http://zookeeper.apache.org/</a><br>
ä¸‹è½½ï¼š <a href="https://archive.apache.org/dist/zookeeper/" target="_blank" rel="noopener">https://archive.apache.org/dist/zookeeper/</a><br>
è§£å‹æ–‡ä»¶åˆ°/usrï¼local/åé…ç½®ç¯å¢ƒï¼švim ï¼etc/profile,æ·»åŠ ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export ZOOKEEPER_HOME=/usr/local/zookeeper</span><br><span class="line">export PATH=$PATH:$ZOOKEEPER_HOME/bin</span><br></pre></td></tr></table></figure>
<p>å®‰è£…å¯åŠ¨é‡åˆ°é—®é¢˜åŠè§£å†³ï¼š</p>
<ul>
<li><a href="https://www.jianshu.com/p/5cd618ad381e" target="_blank" rel="noopener">https://www.jianshu.com/p/5cd618ad381e</a></li>
<li><a href="https://flyer0126.iteye.com/blog/2230958" target="_blank" rel="noopener">https://flyer0126.iteye.com/blog/2230958</a></li>
</ul>
<h1 id="zookeeperä¸»è¦ç›®å½•ç»“æ„"><a class="markdownIt-Anchor" href="#zookeeperä¸»è¦ç›®å½•ç»“æ„"></a> zookeeperä¸»è¦ç›®å½•ç»“æ„</h1>
<p><img src="/pub-images/zookeeper%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84.png" alt="image"></p>
<h1 id="zookeeperé…ç½®æ–‡ä»¶ä»‹ç»"><a class="markdownIt-Anchor" href="#zookeeperé…ç½®æ–‡ä»¶ä»‹ç»"></a> zookeeperé…ç½®æ–‡ä»¶ä»‹ç»</h1>
<ul>
<li>
<p>cp conf/zoo_sample.cfg conf/zoo.cfg</p>
</li>
<li>
<p>tickTime</p>
</li>
<li>
<p>dataDirå¿…é¡»é…ç½®</p>
</li>
<li>
<p>dataLogDirå»ºè®®é…ç½®ï¼Œå¦åˆ™å’ŒdataDirå…¬ç”¨</p>
</li>
<li>
<p>clientPort</p>
</li>
</ul>
<h1 id="zookeeperæ•°æ®æ¨¡å‹"><a class="markdownIt-Anchor" href="#zookeeperæ•°æ®æ¨¡å‹"></a> zookeeperæ•°æ®æ¨¡å‹</h1>
<ul>
<li>æ˜¯ä¸€ä¸ªæ ‘å½¢ç»“æ„ï¼Œç±»ä¼¼äºå‰ç«¯å¼€å‘ä¸­çš„tree.jsç»„ä»¶</li>
<li>zkçš„æ•°æ®æ¨¡å‹ä¹Ÿå¯ä»¥ç†è§£ä¸ºunixï¼linuxçš„æ–‡ä»¶ç›®å½•</li>
<li>æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½æˆä¸ºznodeï¼Œä»–å¯ä»¥æœ‰è‡ªèŠ‚ç‚¹ï¼Œä¹Ÿå¯ä»¥æœ‰æ•°æ®</li>
<li>æ¯ä¸ªèŠ‚ç‚¹åˆ†ä¸ºä¸´æ—¶èŠ‚ç‚¹å’Œæ°¸ä¹…èŠ‚ç‚¹ï¼Œä¸´æ—¶èŠ‚ç‚¹åœ¨å®¢æˆ·ç«¯æ–­å¼€åæ¶ˆå¤±</li>
<li>æ¯ä¸ªzkèŠ‚ç‚¹éƒ½æœ‰å„è‡ªçš„ç‰ˆæœ¬å·ï¼Œå¯ä»¥é€šè¿‡å‘½ä»¤è¡Œæ¥æ˜¾ç¤ºèŠ‚ç‚¹ä¿¡æ¯</li>
<li>æ¯å½“èŠ‚ç‚¹æ•°æ®å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆè¯¥èŠ‚ç‚¹çš„ç‰ˆæœ¬å·ä¼šç´¯åŠ ï¼ˆä¹è§‚é”ï¼‰</li>
<li>åˆ é™¤ï¼ä¿®æ”¹è¿‡æ—¶çš„èŠ‚ç‚¹ï¼Œç‰ˆæœ¬å·ä¸åŒ¹é…åˆ™ä¼šæŠ¥é”™</li>
<li>æ¯ä¸ªzkèŠ‚ç‚¹å­˜å‚¨çš„æ•°æ®ä¸å®œè¿‡å¤§ï¼Œå‡ kå³å¯</li>
<li>èŠ‚ç‚¹å¯ä»¥è®¾ç½®æƒé™aclï¼Œå¯ä»¥é€šè¿‡æƒé™æ¥é™åˆ¶ç”¨æˆ·çš„è®¿é—®</li>
</ul>
<p>åŸºæœ¬æ“ä½œï¼š</p>
<ul>
<li>å®¢æˆ·ç«¯è¿æ¥ï¼šbin/zkCli.sh  å¯ä»¥è¾“å…¥helpå›è½¦æŸ¥çœ‹æ”¯æŒçš„å‘½ä»¤</li>
<li>æŸ¥çœ‹znodeç»“æ„ï¼š lså‘½ä»¤ï¼Œä¸€å±‚å±‚æŸ¥çœ‹</li>
<li>å…³é—­å®¢æˆ·ç«¯è¿æ¥ï¼š ctrl+c</li>
</ul>
<h1 id="zookeeperä½œç”¨ä½“ç°"><a class="markdownIt-Anchor" href="#zookeeperä½œç”¨ä½“ç°"></a> zookeeperä½œç”¨ä½“ç°</h1>
<ul>
<li>masterèŠ‚ç‚¹é€‰ä¸¾ï¼Œä¸»èŠ‚ç‚¹æŒ‚äº†ä¹‹åï¼Œä»èŠ‚ç‚¹å°±ä¼šæ¥æ‰‹å·¥ä½œï¼Œå¹¶ä¸”ä¿è¯è¿™ä¸ªèŠ‚ç‚¹æ˜¯å”¯ä¸€çš„ï¼Œè¿™ä¹Ÿæ˜¯æ‰€è°“çš„é¦–è„‘æ¨¡å¼ï¼Œä»è€Œä¿è¯æˆ‘ä»¬é›†ç¾¤æ˜¯é«˜å¯ç”¨çš„</li>
<li>ç»Ÿä¸€é…ç½®æ–‡ä»¶ç®¡ç†ï¼Œå³åªéœ€éƒ¨ç½²ä¸€å°æœåŠ¡å™¨ï¼Œåˆ™å¯ä»¥æŠŠç›¸åŒçš„é…ç½®æ–‡ä»¶åŒæ­¥æ›´æ–°åˆ°å…¶ä»–æ‰€æœ‰æœåŠ¡å™¨ï¼Œæ­¤æ“ä½œåœ¨äº‘è®¡ç®—ä¸­ç”¨çš„ç‰¹åˆ«å¤šï¼ˆå‡è®¾ä¿®æ”¹äº†redisç»Ÿä¸€é…ç½®ï¼‰</li>
<li>å‘å¸ƒä¸è®¢é˜…ï¼Œç±»ä¼¼äºæ¶ˆæ¯é˜Ÿåˆ—MQï¼ˆamqï¼Œrmqâ€¦ï¼‰ï¼Œdubboå‘å¸ƒè€…æŠŠæ•°æ®å­˜åœ¨znodeä¸Šï¼Œè®¢é˜…è€…ä¼šè¯»å–è¿™ä¸ªæ•°æ®</li>
<li>æä¾›åˆ†å¸ƒå¼é”ï¼Œåˆ†å¸ƒå¼ç¯å¢ƒä¸­ä¸é€šè¿›ç¨‹ä¹‹é—´äº‰å¤ºèµ„æºï¼Œç±»ä¼¼äºå¤šçº¿ç¨‹ä¸­çš„é”</li>
<li>é›†ç¾¤ç®¡ç†ï¼Œé›†ç¾¤ä¸­ä¿è¯æ•°æ®çš„å¼ºä¸€è‡´æ€§</li>
</ul>
<h1 id="å››ç§ç±»å‹çš„znode"><a class="markdownIt-Anchor" href="#å››ç§ç±»å‹çš„znode"></a> å››ç§ç±»å‹çš„znode</h1>
<ul>
<li>PERSISTENT-æŒä¹…åŒ–ç›®å½•èŠ‚ç‚¹ï¼šå®¢æˆ·ç«¯ä¸zookeeperæ–­å¼€è¿æ¥åï¼Œè¯¥èŠ‚ç‚¹ä¾æ—§å­˜åœ¨</li>
<li>PERSISTENT_SEQUENTIAL-æŒä¹…åŒ–é¡ºåºç¼–å·ç›®å½•èŠ‚ç‚¹ï¼šå®¢æˆ·ç«¯ä¸zookeeperæ–­å¼€è¿æ¥åï¼Œè¯¥èŠ‚ç‚¹ä¾æ—§å­˜åœ¨ï¼Œåªæ˜¯Zookeeperç»™è¯¥èŠ‚ç‚¹åç§°è¿›è¡Œé¡ºåºç¼–å·</li>
<li>EPHEMERAL-ä¸´æ—¶ç›®å½•èŠ‚ç‚¹ï¼šå®¢æˆ·ç«¯ä¸zookeeperæ–­å¼€è¿æ¥åï¼Œè¯¥èŠ‚ç‚¹è¢«åˆ é™¤</li>
<li>EPHEMERAL_SEQUENTIAL-ä¸´æ—¶é¡ºåºç¼–å·ç›®å½•èŠ‚ç‚¹ï¼šå®¢æˆ·ç«¯ä¸zookeeperæ–­å¼€è¿æ¥åï¼Œè¯¥èŠ‚ç‚¹è¢«åˆ é™¤ï¼Œåªæ˜¯Zookeeperç»™è¯¥èŠ‚ç‚¹åç§°è¿›è¡Œé¡ºåºç¼–å·</li>
</ul>
<h1 id="ç›‘å¬é€šçŸ¥æœºåˆ¶"><a class="markdownIt-Anchor" href="#ç›‘å¬é€šçŸ¥æœºåˆ¶"></a> ç›‘å¬é€šçŸ¥æœºåˆ¶</h1>
<p>å®¢æˆ·ç«¯æ³¨å†Œç›‘å¬å®ƒå…³å¿ƒçš„ç›®å½•èŠ‚ç‚¹ï¼Œå½“ç›®å½•èŠ‚ç‚¹å‘ç”Ÿå˜åŒ–ï¼ˆæ•°æ®æ”¹å˜ã€è¢«åˆ é™¤ã€å­ç›®å½•èŠ‚ç‚¹å¢åŠ åˆ é™¤ï¼‰æ—¶ï¼Œzookeeperä¼šé€šçŸ¥å®¢æˆ·ç«¯ã€‚</p>
<h1 id="zookeeperå®¢æˆ·ç«¯çš„ä½¿ç”¨"><a class="markdownIt-Anchor" href="#zookeeperå®¢æˆ·ç«¯çš„ä½¿ç”¨"></a> Zookeeperå®¢æˆ·ç«¯çš„ä½¿ç”¨</h1>
<ul>
<li><a href="http://zkCli.sh" target="_blank" rel="noopener">zkCli.sh</a>ï¼šå¯ä½¿ç”¨./zkCli.sh -server localhostæ¥è¿æ¥åˆ°ZookeeperæœåŠ¡ä¸Š</li>
<li>Javaå®¢æˆ·ç«¯ï¼šå¯åˆ›å»ºorg.apache.zookeeper.ZooKeeperå¯¹è±¡æ¥ä½œä¸ºzkçš„å®¢æˆ·ç«¯ï¼Œæ³¨æ„ï¼Œjava apié‡Œåˆ›å»ºzkå®¢æˆ·ç«¯æ˜¯å¼‚æ­¥çš„ï¼Œä¸ºé˜²æ­¢åœ¨å®¢æˆ·ç«¯è¿˜æœªå®Œæˆåˆ›å»ºå°±è¢«ä½¿ç”¨çš„æƒ…å†µï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨åŒæ­¥è®¡æ—¶å™¨ï¼Œç¡®ä¿zkå¯¹è±¡åˆ›å»ºå®Œæˆå†è¢«ä½¿ç”¨</li>
<li>Cå®¢æˆ·ç«¯</li>
</ul>
<h1 id="zookeeperå¸¸ç”¨å‘½ä»¤è¡Œæ“ä½œ"><a class="markdownIt-Anchor" href="#zookeeperå¸¸ç”¨å‘½ä»¤è¡Œæ“ä½œ"></a> zookeeperå¸¸ç”¨å‘½ä»¤è¡Œæ“ä½œ</h1>
<p><img src="/pub-images/zk%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4.png" alt="image"></p>
<p>å¯åŠ¨æœåŠ¡ï¼š./zkServer.shï¼Œè¿æ¥å®¢æˆ·ç«¯è¿›å…¥å‘½ä»¤è¡Œåå°ï¼š./zkCli.sh</p>
<ul>
<li>lsä¸ls2</li>
<li>getä¸stat</li>
</ul>
<p>zkç‰¹æ€§-sessionçš„åŸºæœ¬åŸç†ï¼šå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¹‹é—´çš„è¿æ¥å­˜åœ¨ä¼šè¯ï¼›æ¯ä¸ªä¼šè¯éƒ½å¯ä»¥è®¾ç½®ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼›å¿ƒè·³ç»“æŸï¼Œsessionåˆ™è¿‡æœŸï¼›sessionè¿‡æœŸåˆ™ä¸´æ—¶èŠ‚ç‚¹znodeä¼šè¢«æŠ›å¼ƒ</p>
<p>å¿ƒè·³æœºåˆ¶ï¼šå®¢æˆ·ç«¯å‘æœåŠ¡ç«¯çš„pingåŒ…è¯·æ±‚</p>
<p>zkç‰¹æ€§-watcheræœºåˆ¶ï¼šé’ˆå¯¹æ¯ä¸ªèŠ‚ç‚¹çš„æ“ä½œï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªç›‘ç£è€…watcherï¼›å½“ç›‘æ§çš„æŸä¸ªznodeå‘ç”Ÿäº†å˜åŒ–åˆ™å‡ºå‘watcheräº‹ä»¶ï¼›zkä¸­çš„watcheræ˜¯ä¸€æ¬¡æ€§çš„ï¼Œè§¦å‘åç«‹å³é”€æ¯ï¼›çˆ¶èŠ‚ç‚¹ã€å­èŠ‚ç‚¹å¢åˆ æ”¹éƒ½èƒ½è§¦å‘å…¶watcher</p>
<p>äº‹ä»¶è§¦å‘çš„ç±»å‹åŠåˆ†ç±»</p>
<h1 id="aclaccess-control-listsæƒé™æ§åˆ¶"><a class="markdownIt-Anchor" href="#aclaccess-control-listsæƒé™æ§åˆ¶"></a> ACL(access control lists)æƒé™æ§åˆ¶</h1>
<ul>
<li>é’ˆå¯¹èŠ‚ç‚¹å¯ä»¥è®¾ç½®ç›¸å…³è¯»å†™ç­‰æƒé™ï¼Œç›®çš„ä¸ºäº†ä¿éšœæ•°æ®å®‰å…¨æ€§</li>
<li>æƒé™permissionså¯ä»¥æŒ‡å®šä¸åŒçš„æƒé™èŒƒå›´ä»¥åŠè§’è‰²</li>
</ul>
<p>ç™»å½•ï¼š addauth digest imooc:imooc</p>
<p>aclå‘½ä»¤è¡Œ</p>
<ul>
<li>getAclï¼šè·å–æŸä¸ªèŠ‚ç‚¹çš„aclæƒé™ä¿¡æ¯</li>
<li>setAclï¼šè®¾ç½®æŸä¸ªèŠ‚ç‚¹çš„aclæƒé™ä¿¡æ¯</li>
<li>addauthï¼šè¾“å…¥è®¤è¯æˆæƒä¿¡æ¯ï¼Œæ³¨å†Œæ—¶è¾“å…¥æ˜æ–‡å¯†ç (ç™»å½•),ä½†åœ¨zkçš„ç³»ç»Ÿé‡Œï¼Œå¯†ç æ˜¯ä»¥åŠ å¯†çš„å½¢å¼å­˜åœ¨çš„</li>
</ul>
<p>zkçš„aclé€šè¿‡[schemeğŸ†”permissions]æ¥æ„æˆæƒé™åˆ—è¡¨ï¼š</p>
<ol>
<li>schemeï¼šä»£è¡¨é‡‡ç”¨çš„æŸç§æƒé™æœºåˆ¶</li>
</ol>
<ul>
<li>worldï¼šå®ƒä¸‹é¢åªæœ‰ä¸€ä¸ªid, å«anyone, world:anyoneä»£è¡¨ä»»ä½•äººï¼Œzookeeperä¸­å¯¹æ‰€æœ‰äººæœ‰æƒé™çš„ç»“ç‚¹å°±æ˜¯å±äºworld:anyoneçš„</li>
<li>auth: å®ƒä¸éœ€è¦id, åªè¦æ˜¯é€šè¿‡authenticationçš„useréƒ½æœ‰æƒé™ï¼ˆzookeeperæ”¯æŒé€šè¿‡kerberosæ¥è¿›è¡Œauthencation, ä¹Ÿæ”¯æŒusername/passwordå½¢å¼çš„authentication)</li>
<li>digestï¼šå®ƒå¯¹åº”çš„idä¸ºusername:BASE64(SHA1(password))ï¼Œå®ƒéœ€è¦å…ˆé€šè¿‡username:passwordå½¢å¼çš„authentication</li>
<li>ipï¼š: å®ƒå¯¹åº”çš„idä¸ºå®¢æˆ·æœºçš„IPåœ°å€ï¼Œè®¾ç½®çš„æ—¶å€™å¯ä»¥è®¾ç½®ä¸€ä¸ªipæ®µï¼Œæ¯”å¦‚ip:192.168.1.0/16, è¡¨ç¤ºåŒ¹é…å‰16ä¸ªbitçš„IPæ®µ</li>
<li>super:ä»£è¡¨è¶…çº§ç®¡ç†å‘˜ï¼Œæ‹¥æœ‰æ‰€æœ‰çš„æƒé™</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//ä¿®æ”¹zkServer.shå¢åŠ superç®¡ç†å‘˜</span><br><span class="line">![image](/pub-images/superè®¾ç½®.png)</span><br><span class="line"></span><br><span class="line">//é‡å¯zkServer.sh</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>idï¼šä»£è¡¨å…è®¸è®¿é—®çš„ç”¨æˆ·</li>
<li>permissionsï¼šæƒé™ç»„åˆå­—ç¬¦ä¸²ï¼ˆcrdwaï¼‰</li>
</ol>
<ul>
<li>createï¼šåˆ›å»ºå­èŠ‚ç‚¹</li>
<li>readï¼šè·å–èŠ‚ç‚¹ï¼å­èŠ‚ç‚¹</li>
<li>writeï¼šè®¾ç½®èŠ‚ç‚¹æ•°æ®</li>
<li>deleteï¼šåˆ é™¤å­èŠ‚ç‚¹</li>
<li>adminï¼šè®¾ç½®æƒé™</li>
</ul>
<h1 id="aclå¸¸ç”¨ä½¿ç”¨åœºæ™¯"><a class="markdownIt-Anchor" href="#aclå¸¸ç”¨ä½¿ç”¨åœºæ™¯"></a> aclå¸¸ç”¨ä½¿ç”¨åœºæ™¯</h1>
<ul>
<li>å¼€å‘ï¼æµ‹è¯•ç¯å¢ƒåˆ†ç¦»ï¼Œå¼€å‘è€…æ— æƒé™æ“ä½œæµ‹è¯•åº“çš„èŠ‚ç‚¹ï¼Œåªèƒ½çœ‹</li>
<li>ç”Ÿäº§ç¯å¢ƒä¸Šæ§åˆ¶æŒ‡å®šipçš„æœåŠ¡å¯ä»¥è®¿é—®ç›¸å…³èŠ‚ç‚¹ï¼Œé˜²æ­¢æ··ä¹±</li>
</ul>
<h1 id="zookeeperå››å­—å‘½ä»¤"><a class="markdownIt-Anchor" href="#zookeeperå››å­—å‘½ä»¤"></a> zookeeperå››å­—å‘½ä»¤</h1>
<ul>
<li>zkå¯ä»¥é€šè¿‡ä»–è‡ªèº«æä¾›çš„ç®€å†™å‘½ä»¤æ¥å’ŒæœåŠ¡å™¨è¿›è¡Œäº¤äº’</li>
<li>éœ€è¦ä½¿ç”¨åˆ°ncå‘½ä»¤ï¼Œå®‰è£…ï¼šyum install nc</li>
<li>echo [command] | nc [ip] [port]ï¼Œå¦‚ï¼šecho ruok | nc localhost 2181</li>
<li>stat:æŸ¥çœ‹zkçš„çŠ¶æ€ä¿¡æ¯ï¼Œä»¥åŠæ˜¯å¦mode</li>
<li>ruokï¼šæŸ¥çœ‹å½“å‰zkServeræ˜¯å¦å¯åŠ¨ï¼Œè¿”å›imok</li>
<li>dump: åˆ—å‡ºæœªç»å¤„ç†çš„ä¼šè¯å’Œä¸´æ—¶èŠ‚ç‚¹</li>
<li>confï¼šæŸ¥çœ‹æœåŠ¡å™¨é…ç½®</li>
<li>consï¼šå±•ç¤ºè¿æ¥åˆ°æœåŠ¡å™¨çš„å®¢æˆ·ç«¯ä¿¡æ¯</li>
<li>enviï¼šå±•ç¤ºç¯å¢ƒå˜é‡</li>
<li>mntrï¼šç›‘æ§zkå¥åº·ä¿¡æ¯</li>
<li>wchsï¼šå±•ç¤ºwatcherä¿¡æ¯</li>
</ul>
<p>ç™½åå•è®¾ç½®</p>
<h1 id="zookeeperé›†ç¾¤æ­å»º"><a class="markdownIt-Anchor" href="#zookeeperé›†ç¾¤æ­å»º"></a> zookeeperé›†ç¾¤æ­å»º</h1>
<ul>
<li>zké›†ç¾¤ï¼Œä¸»ä»èŠ‚ç‚¹ï¼Œå¿ƒè·³æœºåˆ¶ï¼ˆé€‰ä¸¾æ¨¡å¼ï¼‰ï¼ŒæœåŠ¡å™¨æ•°ï¼š2n+1</li>
</ul>
<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li>é…ç½®æ•°æ®æ–‡ä»¶ myid 1ï¼2ï¼3 å¯¹åº”server.1/2/3</li>
<li>é€šè¿‡./zkCli.sh -server [ip]:[port]æ£€æµ‹é›†ç¾¤æ˜¯å¦é…ç½®æˆåŠŸ</li>
<li>é€šè¿‡./zkServer.sh statusæŸ¥çœ‹zkèŠ‚ç‚¹åœ¨é›†ç¾¤ä¸­çš„çŠ¶æ€</li>
</ul>
<h2 id="é›†ç¾¤æ­å»ºå‰ç½®"><a class="markdownIt-Anchor" href="#é›†ç¾¤æ­å»ºå‰ç½®"></a> é›†ç¾¤æ­å»ºå‰ç½®</h2>
<p>åœ¨æœ¬åœ°å•æœºé…ç½®zkå¯åŠ¨åŠä¸€èˆ¬æ“ä½œæ­£å¸¸ï¼Œå‡è®¾æœ¬åœ°zkç›®å½•ä¸º:/usr/zookeeper</p>
<h2 id="å•æœºä¼ªåˆ†å¸ƒå¼zké›†ç¾¤æ­å»º"><a class="markdownIt-Anchor" href="#å•æœºä¼ªåˆ†å¸ƒå¼zké›†ç¾¤æ­å»º"></a> å•æœºä¼ªåˆ†å¸ƒå¼zké›†ç¾¤æ­å»º</h2>
<ol>
<li>å‡†å¤‡zkå•ä¸ªèŠ‚ç‚¹</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir /usr/zookerperGroup</span><br><span class="line">sudo cp /usr/zookeeper /usr/zookerperGroup/zk1</span><br><span class="line">sudo cp /usr/zookeeper /usr/zookerperGroup/zk2</span><br><span class="line">sudo cp /usr/zookeeper /usr/zookerperGroup/zk3</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>ä¿®æ”¹ç›¸å…³é…ç½®<br>
ä¾æ¬¡è¿›å…¥zk1ã€zk2ã€zk3çš„confç›®å½•ï¼Œç¼–è¾‘zoo.cfgæ–‡ä»¶:</li>
</ol>
<ul>
<li>ä¿®æ”¹clientPortä¾æ¬¡ä¸ºï¼š2191ï¼Œ2192ï¼Œ2193</li>
<li>ä¿®æ”¹dataDirã€dataLogDirè·¯å¾„ä¸ºï¼šusr/zookerperGroup/zk{X}/dataå’Œusr/zookerperGroup/zk{X}/dataLog</li>
<li>åœ¨æ–‡ä»¶æœ«æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼šï¼ˆæ­¤å¤„IPåœ°å€ä¹Ÿå¯æ”¹ä¸ºå®é™…åœ°å€ï¼‰</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">server.1=127.0.0.1:2888:3888</span><br><span class="line">server.2=127.0.0.1:2889:3889</span><br><span class="line">server.3=127.0.0.1:2890:3890</span><br></pre></td></tr></table></figure>
<p>æ­¤é…ç½®éœ€ç»†å¿ƒï¼Œåˆ‡ä¸å¯æ¼é…ã€å°‘é…ï¼Œæˆ‘çš„é…ç½®å¦‚ä¸‹å›¾ï¼š<br>
<img src="/pub-images/zk%E5%8D%95%E6%9C%BA%E4%BC%AA%E5%88%86%E5%B8%83%E5%BC%8F%E9%85%8D%E7%BD%AE.png" alt="image"></p>
<ol start="3">
<li>åˆ›å»ºmyidæ–‡ä»¶</li>
</ol>
<ul>
<li>ä¾æ¬¡è¿›å…¥zk1ã€zk2ã€zk3çš„dataç›®å½•ï¼Œsudo vim myidï¼Œè¾“å…¥å†…å®¹ä¾æ¬¡ä¸ºï¼š1ï¼Œ2ï¼Œ3ä¿å­˜</li>
</ul>
<ol start="4">
<li>ä¾æ¬¡å¯åŠ¨zkæœåŠ¡</li>
</ol>
<ul>
<li>ä¾æ¬¡è¿›å…¥zk1ã€zk2ã€zk3çš„binç›®å½•ï¼Œå¯åŠ¨zkæœåŠ¡ï¼šsudo ./zkServer.sh start</li>
</ul>
<ol start="5">
<li>æµ‹è¯•é›†ç¾¤</li>
</ol>
<ul>
<li>è¿›å…¥zk1çš„binï¼Œè¿æ¥zkæœåŠ¡å™¨ï¼Œå¦‚ï¼šsudo <a href="http://zkCli.sh" target="_blank" rel="noopener">zkCli.sh</a> -server 127.0.0.1:2191</li>
<li>åœ¨zk1ä¸­åˆ›å»ºèŠ‚ç‚¹ï¼šcreate /test Hello</li>
<li>è¿›å…¥zk2çš„binï¼Œè¿æ¥zkæœåŠ¡å™¨ï¼Œå¦‚ï¼šsudo <a href="http://zkCli.sh" target="_blank" rel="noopener">zkCli.sh</a> -server 127.0.0.1:2192</li>
<li>è·å–testèŠ‚ç‚¹ä¿¡æ¯ï¼Œå¦‚ï¼šls /;get /test</li>
<li>é€šè¿‡sudo ./zkServer statusæŸ¥çœ‹é›†ç¾¤èŠ‚ç‚¹ä¿¡æ¯</li>
</ul>
<h2 id="çœŸå®ç¯å¢ƒzké›†ç¾¤æ­å»º"><a class="markdownIt-Anchor" href="#çœŸå®ç¯å¢ƒzké›†ç¾¤æ­å»º"></a> çœŸå®ç¯å¢ƒzké›†ç¾¤æ­å»º</h2>
<p>éœ€æ³¨æ„ï¼šç¯å¢ƒå˜é‡çš„é…ç½®ï¼Œipé…ç½®ä¸åŒï¼Œç«¯å£å·å¯ä»¥ç›¸åŒ</p>
<h2 id="é›†ç¾¤æµ‹è¯•-é€‰ä¸¾æµ‹è¯•"><a class="markdownIt-Anchor" href="#é›†ç¾¤æµ‹è¯•-é€‰ä¸¾æµ‹è¯•"></a> é›†ç¾¤æµ‹è¯•ã€é€‰ä¸¾æµ‹è¯•</h2>
<h1 id="apiæ“ä½œç›¸å…³ä»£ç "><a class="markdownIt-Anchor" href="#apiæ“ä½œç›¸å…³ä»£ç "></a> APIæ“ä½œç›¸å…³ä»£ç </h1>
<blockquote>
<p>ZooKeeperçš„apiæ”¯æŒå¤šç§è¯­è¨€ï¼Œåœ¨æ“ä½œæ—¶å¯ä»¥é€‰æ‹©ä½¿ç”¨åŒæ­¥apiè¿˜æ˜¯å¼‚æ­¥apiã€‚åŒæ­¥apiä¸€èˆ¬æ˜¯ç›´æ¥è¿”å›ç»“æœï¼Œå¼‚æ­¥apiä¸€èˆ¬æ˜¯é€šè¿‡å›è°ƒæ¥ä¼ é€æ‰§è¡Œç»“æœçš„ï¼Œä¸€èˆ¬æ–¹æ³•ä¸­æœ‰æŸå‚æ•°æ˜¯ç±»AsyncCallbackçš„å†…éƒ¨æ¥å£ï¼Œé‚£ä¹ˆè¯¥æ–¹æ³•åº”è¯¥å°±æ˜¯å¼‚æ­¥è°ƒç”¨ï¼Œå›è°ƒæ–¹æ³•åä¸ºprocessResultã€‚</p>
</blockquote>
<p><a href="https://www.cnblogs.com/leocook/p/zk_0.html" target="_blank" rel="noopener">https://www.cnblogs.com/leocook/p/zk_0.html</a></p>
<p><a href="https://www.cnblogs.com/gaojy/p/6635026.html" target="_blank" rel="noopener">https://www.cnblogs.com/gaojy/p/6635026.html</a></p>
<p><a href="https://www.cnblogs.com/niechen/p/8597344.html" target="_blank" rel="noopener">https://www.cnblogs.com/niechen/p/8597344.html</a></p>
<p>å…¥é—¨ï¼š<a href="https://blog.csdn.net/java_66666/article/details/81015302" target="_blank" rel="noopener">https://blog.csdn.net/java_66666/article/details/81015302</a></p>

          
        
      
    </div>
    
    
    

    <div>
          
    </div>

    

    <div>
      
    </div>


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://chetaofeng.github.io/2019/02/15/ç§»åŠ¨å¼€å‘-Androidä¸­ä¸»é¢˜-Theme-å’Œæ ·å¼-Style-ä½¿ç”¨/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è¡Œé”‹">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/pub-images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è¡Œé”‹">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/15/ç§»åŠ¨å¼€å‘-Androidä¸­ä¸»é¢˜-Theme-å’Œæ ·å¼-Style-ä½¿ç”¨/" itemprop="url">Androidä¸­ä¸»é¢˜(Theme)å’Œæ ·å¼(Style)ä½¿ç”¨</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-02-15T11:00:40+08:00">
                2019-02-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ç§»åŠ¨å¼€å‘/" itemprop="url" rel="index">
                    <span itemprop="name">ç§»åŠ¨å¼€å‘</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="themeå’Œstyleè¯´æ˜"><a class="markdownIt-Anchor" href="#themeå’Œstyleè¯´æ˜"></a> Themeå’ŒStyleè¯´æ˜</h1>
<ul>
<li>Themeæ˜¯å…¨å±€çš„è®¾è®¡é£æ ¼ã€‚styleæ˜¯å±€éƒ¨çš„è®¾è®¡é£æ ¼</li>
<li>Themeæ˜¯ä¸€å¥—UIæ§ä»¶å’ŒActivityçš„æ ·å¼ã€‚å¯ä»¥ç»™Application å’Œ activity è®¾ç½®ä¸»é¢˜ã€‚æ¥è®¾ç½®æ˜¾ç¤ºç•Œé¢çš„æ ·å¼</li>
<li>styleæ˜¯é’ˆå¯¹viewæ¥è¯´çš„ï¼Œæ¯”å¦‚ TextViewï¼ŒEditTextè¿™äº›ï¼Œè€ŒThemeå¿…é¡»é’ˆå¯¹æ•´ä¸ªactivityæˆ–è€… æ•´ä¸ªapplicationï¼Œä½ å¿…é¡»åœ¨AndroidManifest.xmlä¸­ çš„<application>æˆ–è€…<activity>ä¸­å®šä¹‰</activity></application></li>
<li>Styleçš„xmlæ–‡ä»¶è¦æ±‚ï¼š</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1. ä»–çš„æ ¹èŠ‚ç‚¹å¿…é¡» æ˜¯&lt;resources&gt;</span><br><span class="line">2. ç»™&lt;style&gt; å¢åŠ ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„åå­—ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©å¢åŠ ä¸€ä¸ªparentçˆ¶ç±»å±æ€§</span><br><span class="line">3. ä½¿ç”¨æ—¶åªè¦åœ¨å†™æˆ‘ä»¬çš„viewæ—¶ï¼ŒåŠ å…¥styleæ ‡ç­¾å°±å¯ä»¥äº†</span><br><span class="line">    &lt;TextView</span><br><span class="line">        style=&quot;@style/CodeFont&quot;</span><br><span class="line">        android:text=&quot;@string/hello&quot; /&gt;</span><br></pre></td></tr></table></figure>
<h1 id="themeè®¾ç½®"><a class="markdownIt-Anchor" href="#themeè®¾ç½®"></a> Themeè®¾ç½®</h1>
<h2 id="themeè®¾ç½®-2"><a class="markdownIt-Anchor" href="#themeè®¾ç½®-2"></a> Themeè®¾ç½®</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    package=&quot;com.jude.test.education&quot; &gt;</span><br><span class="line"></span><br><span class="line">    &lt;application</span><br><span class="line">        android:allowBackup=&quot;true&quot;</span><br><span class="line">        android:icon=&quot;@mipmap/ic_launcher&quot;</span><br><span class="line">        android:label=&quot;@string/app_name&quot;</span><br><span class="line">        &lt;!--è¿™é‡Œè®¾ç½®çš„æ˜¯æ•´ä¸ªAPPçš„ä¸»é¢˜ï¼Œæ‰€æœ‰activiyå’Œviewéƒ½ä¼šé»˜è®¤ä¸ºè¿™ä¸ªä¸»é¢˜--&gt;</span><br><span class="line">        android:theme=&quot;@style/AppTheme&quot; &gt;</span><br><span class="line">        &lt;activity</span><br><span class="line">            android:name=&quot;.MainActivity&quot;</span><br><span class="line">            android:label=&quot;@string/app_name&quot;</span><br><span class="line">            &lt;!--è¿™é‡Œè®¾ç½®çš„æ˜¯è¿™ä¸ªActivityçš„ä¸»é¢˜ï¼ŒActivityæ‰€æœ‰viewéƒ½ä¼šé»˜è®¤ä¸ºè¿™ä¸ªä¸»é¢˜--&gt;</span><br><span class="line">            android:theme=&quot;@style/AppTheme&quot;</span><br><span class="line">            &gt;</span><br><span class="line">            &lt;intent-filter&gt;</span><br><span class="line">                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;</span><br><span class="line">                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;</span><br><span class="line">            &lt;/intent-filter&gt;</span><br><span class="line">        &lt;/activity&gt;</span><br><span class="line">    &lt;/application&gt;</span><br><span class="line"></span><br><span class="line">&lt;/manifest&gt;</span><br></pre></td></tr></table></figure>
<h2 id="themeç»§æ‰¿å¹¶é‡å†™"><a class="markdownIt-Anchor" href="#themeç»§æ‰¿å¹¶é‡å†™"></a> Themeç»§æ‰¿å¹¶é‡å†™</h2>
<p>åœ¨value-&gt;styleé‡Œå®šä¹‰ä¸»é¢˜ã€‚å¯ä»¥ç»§æ‰¿å¹¶é‡å†™å±æ€§</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- å…¼å®¹ä¸»é¢˜ æ·±è‰²ä¸»é¢˜ activityèƒŒæ™¯é»˜è®¤é»‘è‰²ï¼Œå­—ä½“é»˜è®¤ç™½è‰²--&gt;</span><br><span class="line">&lt;style name=&quot;AppTheme&quot; parent=&quot;Theme.AppCompat&quot;&gt;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- å…¼å®¹ä¸»é¢˜ æµ…è‰²ä¸»é¢˜ activityèƒŒæ™¯é»˜è®¤ç™½è‰² å­—ä½“é»˜è®¤é»‘è‰² --&gt;</span><br><span class="line">&lt;style name=&quot;AppTheme2&quot; parent=&quot;Theme.AppCompat.Light&quot;&gt;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- å…¼å®¹ä¸»é¢˜ æ·±è‰²ä¸»é¢˜ æ— Actionbar--&gt;</span><br><span class="line">&lt;style name=&quot;AppTheme3&quot; parent=&quot;Theme.AppCompat.NoActionBar&quot;&gt;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- å…¼å®¹ä¸»é¢˜ æµ…è‰²ä¸»é¢˜ æ— Actionbar--&gt;</span><br><span class="line">&lt;style name=&quot;AppTheme4&quot; parent=&quot;Theme.AppCompat.Light.NoActionBar&quot;&gt;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<h2 id="ä»£ç ä¸­è®¾ç½®activityä¸»é¢˜"><a class="markdownIt-Anchor" href="#ä»£ç ä¸­è®¾ç½®activityä¸»é¢˜"></a> ä»£ç ä¸­è®¾ç½®Activityä¸»é¢˜</h2>
<ul>
<li>Activity æ˜¯ ContextThemeWrapperçš„å­ç±»ã€‚è€ŒContextThemeWrapperä¸€ä¸ªå¾ˆé‡è¦çš„å±æ€§å°±æ˜¯Theme</li>
<li>å®ä¾‹åŒ–ä¸€ä¸ªViewå¿…é¡»è¦ new View(Context context) ã€‚å› ä¸ºViewéœ€è¦æŠŠAttributesäº¤ç»™Contextçš„Themeæ¥ç¡®å®šä¸€å †å±æ€§(åœ¨ä¸€ä¸ªå«TypedArrayçš„å®¹å™¨é‡Œ)</li>
</ul>
<h2 id="themeè®¾ç½®æ³¨æ„äº‹é¡¹"><a class="markdownIt-Anchor" href="#themeè®¾ç½®æ³¨æ„äº‹é¡¹"></a> Themeè®¾ç½®æ³¨æ„äº‹é¡¹</h2>
<ul>
<li>å¦‚æœä½¿ç”¨ android.support.v7.app.ActionBarActivity å°±å¿…é¡»è¦ç”¨å…¼å®¹ä¸»é¢˜Theme.AppCompatã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ActionBarActivity çš„å­˜åœ¨å°±æ˜¯ä¸ºäº†å…¼å®¹ä½APIã€‚è®©ä»–ä»¬ç”¨ä¸Šé«˜APIçš„ä¸œè¥¿ã€‚æ¯”å¦‚Toolbar</span><br></pre></td></tr></table></figure>
<ul>
<li>Holoä¸»é¢˜æ˜¯Android4.0å¼€å§‹è°·æ­ŒæåŠ›æ¨è¡Œçš„Android Designçš„ä¸»é¢˜</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;style name=&quot;AppTheme5&quot; parent=&quot;android:Theme.Holo&quot;&gt;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>Android5.0è°·æ­Œåˆæ¨å‡ºäº†Material Designæ¥å–ä»£Android Design</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> &lt;style name=&quot;AppTheme5&quot; parent=&quot;android:Theme.Material&quot;&gt;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<h1 id="themeæ¥æº"><a class="markdownIt-Anchor" href="#themeæ¥æº"></a> Themeæ¥æº</h1>
<p>åœ¨Android Studioä¸­ä¹¦å†™ä¸»é¢˜æ—¶éƒ½ä¼šæœ‰è‡ªåŠ¨æç¤º</p>
<ol>
<li>æ¥è‡ªAndroidç³»ç»Ÿè‡ªå¸¦çš„ã€‚è‡ªå¸¦çš„ä¸»é¢˜è¦åŠ ä¸Šâ€œandroid:â€ï¼Œå¦‚ï¼šandroid:Theme.Black</li>
<li>æ¥è‡ªå…¼å®¹åŒ…çš„(æ¯”å¦‚v7å…¼å®¹åŒ…)ã€‚ä½¿ç”¨v7å…¼å®¹åŒ…ä¸­çš„ä¸»é¢˜ä¸éœ€è¦å‰ç¼€ï¼Œç›´æ¥ï¼šTheme.AppCompat</li>
<li>è‡ªå·±å†™ä¸€ä¸ªä¸»é¢˜</li>
</ol>
<h1 id="themeç§ç±»"><a class="markdownIt-Anchor" href="#themeç§ç±»"></a> Themeç§ç±»</h1>
<ul>
<li>æ‰€æœ‰èƒ½åº”ç”¨äºåº”ç”¨ç¨‹åºä¸»é¢˜éƒ½æ˜¯ä»¥â€œTheme.â€å¼€å¤´</li>
<li>åœ¨v7ä¸­æœ‰å¾ˆå¤šä»¥â€œBaseâ€å¼€å¤´çš„ä¸»é¢˜ï¼Œæ˜¯ä¸€äº›çˆ¶ä¸»é¢˜ï¼Œä¸å»ºè®®ç›´æ¥ä½¿ç”¨</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">ç³»ç»Ÿè‡ªå¸¦ä¸»é¢˜ï¼š</span><br><span class="line">API 1:</span><br><span class="line">android:Theme æ ¹ä¸»é¢˜</span><br><span class="line">android:Theme.Black èƒŒæ™¯é»‘è‰²</span><br><span class="line">android:Theme.Light èƒŒæ™¯ç™½è‰²</span><br><span class="line">android:Theme.Wallpaper ä»¥æ¡Œé¢å¢™çº¸ä¸ºèƒŒæ™¯</span><br><span class="line">android:Theme.Translucent é€æ˜èƒŒæ™¯</span><br><span class="line">android:Theme.Panel å¹³æ¿é£æ ¼</span><br><span class="line">android:Theme.Dialog å¯¹è¯æ¡†é£æ ¼</span><br><span class="line"></span><br><span class="line">API 11:</span><br><span class="line">android:Theme.Holo Holoæ ¹ä¸»é¢˜</span><br><span class="line">android:Theme.Holo.Black Holoé»‘ä¸»é¢˜</span><br><span class="line">android:Theme.Holo.Light Holoç™½ä¸»é¢˜</span><br><span class="line"></span><br><span class="line">API 14:</span><br><span class="line">Theme.DeviceDefault è®¾å¤‡é»˜è®¤æ ¹ä¸»é¢˜</span><br><span class="line">Theme.DeviceDefault.Black è®¾å¤‡é»˜è®¤é»‘ä¸»é¢˜</span><br><span class="line">Theme.DeviceDefault.Light è®¾å¤‡é»˜è®¤ç™½ä¸»é¢˜</span><br><span class="line"></span><br><span class="line">API 21: (ç½‘ä¸Šå¸¸è¯´çš„ Android Material Design å°±æ˜¯è¦ç”¨è¿™ç§ä¸»é¢˜)</span><br><span class="line">Theme.Material Materialæ ¹ä¸»é¢˜</span><br><span class="line">Theme.Material.Light Materialç™½ä¸»é¢˜</span><br><span class="line"></span><br><span class="line">================================================================</span><br><span class="line">å…¼å®¹åŒ…v7ä¸­å¸¦çš„ä¸»é¢˜ï¼š</span><br><span class="line">Theme.AppCompat å…¼å®¹ä¸»é¢˜çš„æ ¹ä¸»é¢˜</span><br><span class="line">Theme.AppCompat.Black å…¼å®¹ä¸»é¢˜çš„é»‘è‰²ä¸»é¢˜</span><br><span class="line">Theme.AppCompat.Light å…¼å®¹ä¸»é¢˜çš„ç™½è‰²ä¸»é¢˜</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h1 id="themeé£æ ¼ç§ç±»"><a class="markdownIt-Anchor" href="#themeé£æ ¼ç§ç±»"></a> Themeé£æ ¼ç§ç±»</h1>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Black é»‘è‰²é£æ ¼</span><br><span class="line">Light å…‰æ˜é£æ ¼</span><br><span class="line">Dark é»‘æš—é£æ ¼</span><br><span class="line">DayNight ç™½æ˜¼é£æ ¼</span><br><span class="line">Wallpaper å¢™çº¸ä¸ºèƒŒæ™¯</span><br><span class="line">Translucent é€æ˜èƒŒæ™¯</span><br><span class="line">Panel å¹³æ¿é£æ ¼</span><br><span class="line">Dialog å¯¹è¯æ¡†é£æ ¼</span><br><span class="line">NoTitleBar æ²¡æœ‰TitleBar</span><br><span class="line">NoActionBar æ²¡æœ‰ActionBar</span><br><span class="line">Fullscreen å…¨å±é£æ ¼</span><br><span class="line">MinWidth å¯¹è¯æ¡†æˆ–è€…ActionBarçš„å®½åº¦æ ¹æ®å†…å®¹å˜åŒ–ï¼Œè€Œä¸æ˜¯å……æ»¡å…¨å±</span><br><span class="line">WhenLarge å¯¹è¯æ¡†å……æ»¡å…¨å±</span><br><span class="line">TranslucentDecor åŠé€æ˜é£æ ¼</span><br><span class="line">NoDisplay ä¸æ˜¾ç¤ºï¼Œä¹Ÿå°±æ˜¯éšè—äº†</span><br><span class="line">WithActionBar åœ¨æ—§ç‰ˆä¸»é¢˜ä¸Šæ˜¾ç¤ºActionBar</span><br></pre></td></tr></table></figure>
<h1 id="æ¯ä¸ªä¸»é¢˜ä¸­å®šä¹‰itemåˆ†ç±»"><a class="markdownIt-Anchor" href="#æ¯ä¸ªä¸»é¢˜ä¸­å®šä¹‰itemåˆ†ç±»"></a> æ¯ä¸ªä¸»é¢˜ä¸­å®šä¹‰itemåˆ†ç±»</h1>
<p><a href="https://yq.aliyun.com/articles/72108" target="_blank" rel="noopener">https://yq.aliyun.com/articles/72108</a></p>
<p>é¢œè‰²ã€å­—ä½“ã€æŒ‰é’®ã€listã€windowã€Dialogã€AlertDialogã€Panelã€æ»šåŠ¨æ¡ã€æ–‡å­—é€‰ä¸­ï¼ˆText Selectionï¼‰ã€Widgetæ ·å¼ã€Preferenceæ ·å¼ã€searchæ§ä»¶æ ·å¼ã€ActionBaræ ·å¼ã€å…¶ä»–æ ·å¼</p>

          
        
      
    </div>
    
    
    

    <div>
          
    </div>

    

    <div>
      
    </div>


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://chetaofeng.github.io/2019/02/14/å…¶ä»–-svnè¿ç§»/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è¡Œé”‹">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/pub-images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è¡Œé”‹">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/14/å…¶ä»–-svnè¿ç§»/" itemprop="url">SVNè¿ç§»</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-02-14T16:24:30+08:00">
                2019-02-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/å·¥å…·/" itemprop="url" rel="index">
                    <span itemprop="name">å·¥å…·</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>SVN_Rootä¸ºæ‰€æœ‰SVNæ“ä½œæ ¹ç›®å½•ï¼ŒåŒ…æ‹¬æ‰€æœ‰çš„è½¯ä»¶ã€èµ„æºåº“ç­‰</p>
<ul>
<li>Softï¼šä¸ºæ­å»ºSVNç¯å¢ƒç›¸å…³çš„è½¯ä»¶</li>
<li>Subversionï¼šä¸ºSVNæœåŠ¡ç«¯è½¯ä»¶å®‰è£…ç›®å½•</li>
<li>SVN_BAKï¼šä¸ºSVNå¤‡ä»½æ–‡ä»¶</li>
<li>repos:SVNä»“åº“çš„æ ¹ç›®å½•</li>
<li>ReadMeï¼šå½“å‰ç›®å½•è¯´æ˜æ–‡ä»¶</li>
</ul>
<p>æ‰€æœ‰å‘½ä»¤è¡Œæ“ä½œéœ€è¦ç®¡ç†å‘˜æƒé™</p>
<p>æœåŠ¡å¯åŠ¨ï¼š<br>
svnserve.exe -d -r D:\SVN_Root\repos</p>
<p>SVNè¿˜åŸ<br>
svnadmin load D:\SVN_Root\repos\repos &lt; D:\repos.dump</p>
<p>æ³¨å†Œä¸ºç³»ç»ŸæœåŠ¡<br>
sc create svn binpath= â€œâ€œD:\SVN_Root\Subversion\bin\svnserve.exeâ€ --service -r D:\SVN_Root\reposâ€ displayname= â€œSubversion Serverâ€ depend= Tcpip start= auto</p>
<p>é¡¹ç›®æ›´æ¢æœåŠ¡å™¨ï¼Œéœ€è¿ç§»SVNï¼Œç°è®°å½•è¿‡ç¨‹ã€‚</p>
<p>Subversionç®€ä»‹</p>
<ol>
<li>Subversionï¼ˆç®€ç§°SVNï¼‰æ˜¯ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„å¼€æºç‰ˆæœ¬æ§åˆ¶å·¥å…·ï¼Œæ”¯æŒLinuxå’ŒWindowså¹³å°ã€‚</li>
<li>SVNå¯ä»¥æœ‰ä¸¤ä¸ªè®¿é—®æ–¹å¼ï¼Œä¸€ç§æ˜¯ç‹¬ç«‹æœåŠ¡å™¨ç›´æ¥è®¿é—®ï¼Œå³åˆ©ç”¨svnserveå‘½ä»¤å¯åŠ¨æœåŠ¡ï¼Œé€šè¿‡svn://yourdomain.com/projectè¿›è¡Œè®¿é—®å’Œæ“ä½œã€‚å¦ä¸€ç§ç»“åˆapacheï¼Œåˆ©ç”¨HTTPåè®®ï¼Œé€šè¿‡http://yourdomain.com/svn/projectè¿›è¡Œè®¿é—®åŠå„ç±»æ“ä½œã€‚å¦‚æœæœåŠ¡å™¨éœ€è¦åœ¨äº’è”ç½‘ä¸Šå…±äº«ï¼Œä¸€èˆ¬é€‰æ‹©åä¸€ç§æ–¹å¼ã€‚</li>
<li>é€šå¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœé€‰æ‹©SVN Serverå’ŒApache HTTP Serverå„è‡ªç‹¬ç«‹å®‰è£…ï¼Œé…ç½®èµ·æ¥ä¼šæ¯”è¾ƒç¹çã€‚</li>
</ol>
<p>è½¯ä»¶ä¸‹è½½<br>
æœåŠ¡å™¨ï¼šSubversion v1.7 <a href="http://sourceforge.net/projects/win32svn/" target="_blank" rel="noopener">http://sourceforge.net/projects/win32svn/</a><br>
å®¢æˆ·ç«¯ï¼šTortoisesvn V1.7 <a href="http://tortoisesvn.net/downloads.html" target="_blank" rel="noopener">http://tortoisesvn.net/downloads.html</a></p>
<p>ç»“æ„è¯´æ˜<br>
D:/svnroot<br>
â”œâ”€project1<br>
â”‚     â”œâ”€conf<br>
â”‚     â”œâ”€dav<br>
â”‚     â”œâ”€db<br>
â”‚     â”‚     â”œâ”€revprops<br>
â”‚     â”‚     â”œâ”€revs<br>
â”‚     â”‚     â””â”€transactions<br>
â”‚     â”œâ”€hooks<br>
â”‚     â””â”€locks<br>
â””â”€project2<br>
â”œâ”€conf<br>
â”œâ”€dav<br>
â”œâ”€db<br>
â”‚     â”œâ”€revprops<br>
â”‚     â”œâ”€revs<br>
â”‚     â””â”€transactions<br>
â”œâ”€hooks<br>
â””â”€locks<br>
å…¶ä¸­ï¼šsvnrootæ–‡ä»¶å¤¹ä¸ºå­˜æ”¾æ‰€æœ‰ä»“åº“ï¼Œä¹Ÿæ˜¯æœåŠ¡å¯åŠ¨çš„æ—¶å€™éœ€æŒ‡å®šçš„ç›®å½•ï¼Œä¸‹é¢çš„å„é¡¹ä¸ºé¡¹ç›®ç›®å½•</p>
<p>å¯åŠ¨æœåŠ¡<br>
å¯åŠ¨ç‹¬ç«‹æœåŠ¡æ–¹å¼<br>
svnserve â€“d â€“r e:/svn_repository/<br>
è®¿é—®æ–¹æ³•ï¼šsvn://localhost/devï¼Œæˆ–file:///3:/svn_repository/dev<br>
å¯åŠ¨apacheæ–¹å¼<br>
cd D:/Program Files/CollabNet Subversion Server/httpd/bin<br>
httpd.exe<br>
è®¿é—®æ–¹æ³•ï¼š<a href="http://localhost/svn/dev/" target="_blank" rel="noopener">http://localhost/svn/dev/</a></p>
<p>æœ¬é¡¹ç›®æ‰€ä½¿ç”¨è¿‡ç¨‹<br>
æ‰€æœ‰å‘½ä»¤è¡Œæ“ä½œéœ€è¦ç®¡ç†å‘˜æƒé™<br>
1.æœåŠ¡å¯åŠ¨ï¼š<br>
svnserve.exe -d -r D:\SVN_Root\repos<br>
2.SVNå¤‡ä»½ï¼ˆä»æºæœåŠ¡å™¨å¤‡ä»½ï¼Œå¦‚ï¼š192.168.11.121ï¼‰ï¼š<br>
Aï¼šsvnadmin dump d:\svn\repos\project1&gt; dump.dump &gt;D:\repos.dump      .dumpåç¼€ä¸èƒ½ä¸¢<br>
Bï¼šå¤‡ä»½d:\svn\repos\project1ä¸‹confç›®å½•<br>
3.SVNè¿˜åŸï¼ˆæ‹·è´.dumpæ–‡ä»¶åˆ°ç›®çš„æœåŠ¡å™¨ï¼Œå¦‚ï¼š192.168.7.116ï¼‰ï¼š<br>
Aï¼šsvnadmin create D:\SVN_Root\repos\project1<br>
Bï¼šsvnadmin load D:\SVN_Root\repos\project1 &lt; D:\repos.dump<br>
Cï¼šæ‹·è´2.Bä¸­å¤‡ä»½çš„confæ–‡ä»¶å¤¹è¦†ç›–D:\SVN_Root\repos\project1ä¸‹confæ–‡ä»¶<br>
4.æ³¨å†Œä¸ºç³»ç»ŸæœåŠ¡<br>
sc create svn binpath= â€œâ€œD:\SVN_Root\Subversion\bin\svnserve.exeâ€ --service -r D:\SVN_Root\reposâ€ displayname= â€œSubversion Serverâ€ depend= Tcpip start= auto</p>
<p>èè¯»ï¼š<br>
svnadminå‘½ä»¤ï¼š<br>
<a href="http://blog.csdn.net/wzq9706/article/details/7319728" target="_blank" rel="noopener">http://blog.csdn.net/wzq9706/article/details/7319728</a><br>
<a href="http://www.ityen.com/archives/529" target="_blank" rel="noopener">http://www.ityen.com/archives/529</a><br>
svnå‘½ä»¤ï¼š<a href="http://blog.sina.com.cn/s/blog_963453200101eiuq.html%EF%BC%8Csvn%E5%91%BD%E4%BB%A4%E4%B9%9F%E5%8F%AF%E9%80%9A%E8%BF%87Tortoisesvn%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%93%8D%E4%BD%9C%E4%BB%A3%E6%9B%BF" target="_blank" rel="noopener">http://blog.sina.com.cn/s/blog_963453200101eiuq.htmlï¼Œsvnå‘½ä»¤ä¹Ÿå¯é€šè¿‡Tortoisesvnå®¢æˆ·ç«¯æ“ä½œä»£æ›¿</a></p>

          
        
      
    </div>
    
    
    

    <div>
          
    </div>

    

    <div>
      
    </div>


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://chetaofeng.github.io/2019/02/14/æ•°æ®åº“-2018-12-10-MongoDBé›†ç¾¤æ­å»º/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è¡Œé”‹">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/pub-images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è¡Œé”‹">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/14/æ•°æ®åº“-2018-12-10-MongoDBé›†ç¾¤æ­å»º/" itemprop="url">MongoDBé›†ç¾¤æ­å»º</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-02-14T16:23:24+08:00">
                2019-02-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/æ•°æ®åº“/" itemprop="url" rel="index">
                    <span itemprop="name">æ•°æ®åº“</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##é›†ç¾¤ç¯å¢ƒ:ä¸‰å°æœåŠ¡å™¨</p>
<h3 id="server110620128ä¸»server210620135ä»server310620159ä»"><a class="markdownIt-Anchor" href="#server110620128ä¸»server210620135ä»server310620159ä»"></a> server1:10.62.0.128ä¸»;server2:10.62.0.135ä»;server3:10.62.0.159ä»</h3>
<h4 id="æ¯ä¸€å°åˆ†ä¸º6ä¸ªç‰‡shard1~shard6ç«¯å£ä¸º470174701847019470204702147022æ¯ä¸€ç‰‡å»ºä¸‰ä¸ªå‰¯æœ¬é›†é…ç½®æœåŠ¡å™¨ç«¯å£å·37017è·¯ç”±æœåŠ¡å™¨ç«¯å£å·30000"><a class="markdownIt-Anchor" href="#æ¯ä¸€å°åˆ†ä¸º6ä¸ªç‰‡shard1~shard6ç«¯å£ä¸º470174701847019470204702147022æ¯ä¸€ç‰‡å»ºä¸‰ä¸ªå‰¯æœ¬é›†é…ç½®æœåŠ¡å™¨ç«¯å£å·37017è·¯ç”±æœåŠ¡å™¨ç«¯å£å·30000"></a> æ¯ä¸€å°åˆ†ä¸º6ä¸ªç‰‡ï¼šshard1~shard6ç«¯å£ä¸º47017,47018,47019,47020,47021,47022ï¼›æ¯ä¸€ç‰‡å»ºä¸‰ä¸ªå‰¯æœ¬é›†ï¼›é…ç½®æœåŠ¡å™¨ç«¯å£å·ï¼š37017ï¼›è·¯ç”±æœåŠ¡å™¨ç«¯å£å·ï¼š30000ï¼›</h4>
<h3 id="1è§£å‹å®‰è£…æ–‡ä»¶"><a class="markdownIt-Anchor" href="#1è§£å‹å®‰è£…æ–‡ä»¶"></a> (1).è§£å‹å®‰è£…æ–‡ä»¶</h3>
<pre><code>[gsunis@gsunis Desktop]$ tar zxvf mongodb-linux-x86_64-3.0.6.tgz
</code></pre>
<h3 id="2å°†mongodbæ–‡ä»¶ç§»åŠ¨åˆ°homegsunismongodbç›®å½•ä¸‹"><a class="markdownIt-Anchor" href="#2å°†mongodbæ–‡ä»¶ç§»åŠ¨åˆ°homegsunismongodbç›®å½•ä¸‹"></a> (2).å°†mongoDBæ–‡ä»¶ç§»åŠ¨åˆ°/home/gsunis/mongodbç›®å½•ä¸‹</h3>
<pre><code>[root@gsunis Desktop]# mv mongodb-linux-x86_64-3.0.6 /home/gsunis/mongodb
</code></pre>
<h3 id="3æ•°æ®å­˜å‚¨ç›®å½•"><a class="markdownIt-Anchor" href="#3æ•°æ®å­˜å‚¨ç›®å½•"></a> (3).æ•°æ®å­˜å‚¨ç›®å½•</h3>
<pre><code>[root@gsunis bin]# mkdir -p /home/gsunis/data/db
</code></pre>
<h3 id="4å¯åŠ¨mongodæœåŠ¡"><a class="markdownIt-Anchor" href="#4å¯åŠ¨mongodæœåŠ¡"></a> (4).å¯åŠ¨mongodæœåŠ¡</h3>
<pre><code>[root@gsunis Desktop]# cd /home/gsunis/mongodb/bin
[root@gsunis bin]# ./mongod --port 27017 --dbpath=/home/gsunis/data/db
</code></pre>
<h3 id="5å¯åŠ¨mongoå®¢æˆ·ç«¯"><a class="markdownIt-Anchor" href="#5å¯åŠ¨mongoå®¢æˆ·ç«¯"></a> (5).å¯åŠ¨mongoå®¢æˆ·ç«¯</h3>
<pre><code>æ‰“å¼€æ–°çš„Terminal
[gsunis@gsunis Desktop]$ su 
æŸ¥çœ‹mongodæœåŠ¡å¯åŠ¨æƒ…å†µ
[root@gsunis Desktop]# netstat -ntpl | grep 27017

[root@gsunis Desktop]# cd /home/gsunis/mongodb/bin/
[root@gsunis bin]# ./mongo
</code></pre>
<p>###æ­£å¸¸å…³é—­mongoDBæœåŠ¡</p>
<pre><code>./mongo
use admin
db.shutdownServer() æˆ–è€…ps -ef|grep mongodb  kill -2 pid
</code></pre>
<p>##ä»¥ä¸Šæ˜¯ç®€å•çš„å®‰è£…mongodbï¼Œä¸‹é¢æ˜¯å¼€å§‹å»ºç«‹é›†ç¾¤ï¼Œåˆ†ç‰‡å’Œå»ºç«‹å‰¯æœ¬é›†</p>
<p>###åˆ›å»ºç›®å½•<br>
mkdir -p /data/conf<br>
mkdir -p /data/data1<br>
mkdir -p /data/data2<br>
mkdir -p /data/data3<br>
mkdir -p /data/data4<br>
mkdir -p /data/data5<br>
mkdir -p /data/data6</p>
<h3 id="6ç¼–è¾‘mongoé…ç½®æ–‡ä»¶"><a class="markdownIt-Anchor" href="#6ç¼–è¾‘mongoé…ç½®æ–‡ä»¶"></a> (6).ç¼–è¾‘mongoé…ç½®æ–‡ä»¶</h3>
<pre><code>sudo vi conf.cnf

//conf.cnf   
port=37017  
dbpath=/home/gsunis/data/conf  
logappend = true  
fork=true  
logpath=/home/gsunis/data/conf/mongodb.log  
nojournal=false  
configsvr=true  
profile=1 

sudo vi db1.cnf

//db1.cnf  
replSet=shard1  
port=47017  
dbpath=/home/gsunis/data/data1  
logappend = true  
fork=true  
logpath=/home/gsunis/data/data1/mongodb.log  
nojournal=false  
shardsvr=true  
profile=1  

sudo vi db2.cnf

//db2.cnf  
replSet=shard2   
port=47018  
dbpath=/home/gsunis/data/data2  
logappend = true  
fork=true  
logpath=/home/gsunis/data/data2/mongodb.log  
nojournal=false  
shardsvr=true  
profile=1  

sudo vi db3.cnf

//db3.cnf  
replSet=shard3  
port=47019  
dbpath=/home/gsunis/data/data3  
logappend = true  
fork=true  
logpath=/home/gsunis/data/data3/mongodb.log  
nojournal=false  
shardsvr=true  
profile=1  

sudo vi db4.cnf

//db4.cnf  
replSet=shard4   
port=47020  
dbpath=/home/gsunis/data/data4  
logappend = true  
fork=true  
logpath=/home/gsunis/data/data4/mongodb.log  
nojournal=false  
shardsvr=true  
profile=1  

sudo vi db5.cnf

//db5.cnf  
replSet=shard5   
port=47021  
dbpath=/home/gsunis/data/data5  
logappend = true  
fork=true  
logpath=/home/gsunis/data/data5/mongodb.log  
nojournal=false  
shardsvr=true  
profile=1  

sudo vi db6.cnf

//db6.cnf  
replSet=shard6   
port=47022  
dbpath=/home/gsunis/data/data6  
logappend = true  
fork=true  
logpath=/home/gsunis/data/data6/mongodb.log  
nojournal=false  
shardsvr=true  
profile=1  
</code></pre>
<h4 id="7ç¼–å†™å¯åŠ¨mongoæœåŠ¡çš„è„šæœ¬"><a class="markdownIt-Anchor" href="#7ç¼–å†™å¯åŠ¨mongoæœåŠ¡çš„è„šæœ¬"></a> (7).ç¼–å†™å¯åŠ¨mongoæœåŠ¡çš„è„šæœ¬</h4>
<pre><code>sudo vi mg.sh

#!/bin/bash  
instance=$1  
action=$2  
case &quot;$action&quot; in  
   'start')  
/home/gsunis/mongodb/bin/mongod -f /home/gsunis/data/&quot;$instance&quot;.cnf ;;  
   'stop')  
/home/gsunis/mongodb/bin/mongod -f /home/gsunis/data/&quot;$instance&quot;.cnf --shutdown;;  
   'restart')  
/home/gsunis/mongodb/bin/mongod -f /home/gsunis/data/&quot;$instance&quot;.cnf --shutdown  
/home/gsunis/mongodb/bin/mongod -f /home/gsunis/data/&quot;$instance&quot;.cnf;;  
esac  
</code></pre>
<h4 id="8å¯åŠ¨mongoæœåŠ¡è„šæœ¬"><a class="markdownIt-Anchor" href="#8å¯åŠ¨mongoæœåŠ¡è„šæœ¬"></a> (8).å¯åŠ¨mongoæœåŠ¡è„šæœ¬</h4>
<pre><code>sudo vi start.sh

#!/bin/bash 
rm /data/conf/*.lock
rm /data/data1/*.lock	
rm /data/data2/*.lock
rm /data/data3/*.lock
rm /data/data4/*.lock
rm /data/data5/*.lock
rm /data/data6/*.lock
/home/gsunis/data/mg.sh db1 start  
/home/gsunis/data/mg.sh db2 start  
/home/gsunis/data/mg.sh db3 start  
/home/gsunis/data/mg.sh db4 start  
/home/gsunis/data/mg.sh db5 start
/home/gsunis/data/mg.sh db6 start  
</code></pre>
<p>sudo vi <a href="http://stop.sh" target="_blank" rel="noopener">stop.sh</a></p>
<pre><code>#!/bin/bash 
/home/gsunis/data/mg.sh conf stop 
/home/gsunis/data/mg.sh db1 stop  
/home/gsunis/data/mg.sh db2 stop  
/home/gsunis/data/mg.sh db3 stop  
/home/gsunis/data/mg.sh db4 stop  
/home/gsunis/data/mg.sh db5 stop
/home/gsunis/data/mg.sh db6 stop  
</code></pre>
<p>###å‡†å¤‡å·¥ä½œåšå¥½ï¼Œå…ˆå¯åŠ¨é…ç½®æœåŠ¡å™¨ï¼ˆå…ˆå¯åŠ¨ä¸»ï¼Œä¾æ¬¡å¯åŠ¨ä¸¤ä»æœºï¼‰<br>
/home/gsunis/data/mg.sh conf start<br>
###å†å¯åŠ¨è·¯ç”±æœåŠ¡å™¨ï¼ˆå…ˆå¯åŠ¨ä¸»ï¼Œä¾æ¬¡å¯åŠ¨ä¸¤ä»æœºï¼‰<br>
/home/gsunis/mongodb/bin/mongos  --configdb 10.62.0.128:37017,10.62.0.135:37017,10.62.0.159:37017 --port 30000 --chunkSize 1 --logpath /home/gsunis/data/mongos1.log --logappend --fork<br>
###æœ€åå¯åŠ¨mongodï¼ˆå…ˆå¯åŠ¨ä¸»ï¼Œä¾æ¬¡å¯åŠ¨ä¸¤ä»æœºï¼‰<br>
/home/gsunis/mongodb/data/start.sh</p>
<h3 id="9shardæœåŠ¡å™¨å‰¯æœ¬é›†çš„å»ºç«‹åªéœ€è¦åœ¨ä¸»æœºä¸Šåšå³å¯ä¸¤ä»æœºä¼šè‡ªåŠ¨å¤åˆ¶"><a class="markdownIt-Anchor" href="#9shardæœåŠ¡å™¨å‰¯æœ¬é›†çš„å»ºç«‹åªéœ€è¦åœ¨ä¸»æœºä¸Šåšå³å¯ä¸¤ä»æœºä¼šè‡ªåŠ¨å¤åˆ¶"></a> (9).shardæœåŠ¡å™¨å‰¯æœ¬é›†çš„å»ºç«‹ï¼ˆåªéœ€è¦åœ¨ä¸»æœºä¸Šåšå³å¯ï¼Œä¸¤ä»æœºä¼šè‡ªåŠ¨å¤åˆ¶ï¼‰</h3>
<pre><code>./mongo --port 47017

config = {_id: 'shard1', members: [
 {_id: 0, host: '10.62.0.128:47017'},
 {_id: 1, host: '10.62.0.135:47017'},
 {_id: 2, host: '10.62.0.159:47017'}]
 }
rs.initiate(config)

Ctrl + C é€€å‡º
</code></pre>
<ul>
<li>rs.add({&quot;_id&quot;:2,â€œhostâ€:â€œ10.62.0.135:47017â€})	#åœ¨çº¿å¢åŠ å¤åˆ¶é›†</li>
</ul>
<hr>
<pre><code>./mongo --port 47018

config = {_id: 'shard2', members: [
 {_id: 0, host: '10.62.0.128:47018'},
 {_id: 1, host: '10.62.0.135:47018'},
 {_id: 2, host: '10.62.0.159:47018'}]
 }
rs.initiate(config)


./mongo --port 47019

config = {_id: 'shard3', members: [
 {_id: 0, host: '10.62.0.128:47019'},
 {_id: 1, host: '10.62.0.135:47019'},
 {_id: 2, host: '10.62.0.159:47019'}]
 }
rs.initiate(config)


./mongo --port 47020

config = {_id: 'shard4', members: [
 {_id: 0, host: '10.62.0.128:47020'},
 {_id: 1, host: '10.62.0.135:47020'},
 {_id: 2, host: '10.62.0.159:47020'}]
 }
rs.initiate(config)

./mongo --port 47021

config = {_id: 'shard5', members: [
 {_id: 0, host: '10.62.0.128:47021'},
 {_id: 1, host: '10.62.0.135:47021'},
 {_id: 2, host: '10.62.0.159:47021'}]
 }
rs.initiate(config)


./mongo --port 47022

config = {_id: 'shard6', members: [
 {_id: 0, host: '10.62.0.128:47022'},
 {_id: 1, host: '10.62.0.135:47022'},
 {_id: 2, host: '10.62.0.159:47022'}]
 }
rs.initiate(config)
</code></pre>
<h2 id="é…ç½®shardingç™»å½•åˆ°mongosæ·»åŠ shardèŠ‚ç‚¹"><a class="markdownIt-Anchor" href="#é…ç½®shardingç™»å½•åˆ°mongosæ·»åŠ shardèŠ‚ç‚¹"></a> é…ç½®sharding:ç™»å½•åˆ°mongosï¼Œæ·»åŠ shardèŠ‚ç‚¹</h2>
<pre><code>./mongo --port 30000

use admin

db.runCommand({addshard:&quot;shard1/10.62.0.128:47017,10.62.0.159:47017,10.62.0.135:47017&quot;});
db.runCommand({addshard:&quot;shard2/10.62.0.128:47018,10.62.0.159:47018,10.62.0.135:47018&quot;});
db.runCommand({addshard:&quot;shard3/10.62.0.128:47019,10.62.0.159:47019,10.62.0.135:47019&quot;});
db.runCommand({addshard:&quot;shard4/10.62.0.128:47020,10.62.0.159:47020,10.62.0.135:47020&quot;});
db.runCommand({addshard:&quot;shard5/10.62.0.128:47021,10.62.0.159:47021,10.62.0.135:47021&quot;});
db.runCommand({addshard:&quot;shard6/10.62.0.128:47022,10.62.0.159:47022,10.62.0.135:47022&quot;});


use config

db.shards.find()
</code></pre>
<h4 id="å¯åŠ¨è·¯ç”±æœåŠ¡å‡ºé”™"><a class="markdownIt-Anchor" href="#å¯åŠ¨è·¯ç”±æœåŠ¡å‡ºé”™"></a> å¯åŠ¨è·¯ç”±æœåŠ¡å‡ºé”™</h4>
<p>é”™è¯¯ï¼š</p>
<p><img src="http://i.imgur.com/Usu4wPa.png" alt="æ—¶é’Ÿä¸åŒæ­¥ï¼Œå¯¼è‡´æ— æ³•å¯åŠ¨è·¯ç”±æœåŠ¡"></p>
<p>è§£å†³æ–¹æ³•ï¼š</p>
<ul>
<li>(1).å…³é—­æ‰€æœ‰mongoç›¸å…³æœåŠ¡</li>
<li>(2).å…ˆå¯é…ç½®æœåŠ¡ 		Config Server</li>
<li>(3).å¯åŠ¨è·¯ç”±æœåŠ¡		mongos</li>
<li>(4).æœ€åå¯åŠ¨æ‰€æœ‰mongodæœåŠ¡	mongod<br>
###è¿œç¨‹copy<br>
scp /home/gsunis/Tools/mongodb-linux-x86_64-3.0.6.tgz <a href="mailto:gsunis@10.62.0.135" target="_blank" rel="noopener">gsunis@10.62.0.135</a>:/home/gsunis/</li>
</ul>

          
        
      
    </div>
    
    
    

    <div>
          
    </div>

    

    <div>
      
    </div>


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://chetaofeng.github.io/2019/02/14/æ•°æ®åº“-2018-12-10-MongoDBæ­å»º/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è¡Œé”‹">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/pub-images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è¡Œé”‹">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/14/æ•°æ®åº“-2018-12-10-MongoDBæ­å»º/" itemprop="url">MongoDBå®‰è£…</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-02-14T16:23:15+08:00">
                2019-02-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/æ•°æ®åº“/" itemprop="url" rel="index">
                    <span itemprop="name">æ•°æ®åº“</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1è§£å‹å®‰è£…æ–‡ä»¶"><a class="markdownIt-Anchor" href="#1è§£å‹å®‰è£…æ–‡ä»¶"></a> (1).è§£å‹å®‰è£…æ–‡ä»¶</h3>
<pre><code>[gsunis@gsunis Desktop]$ tar zxvf mongodb-linux-x86_64-3.0.6.tgz
</code></pre>
<h3 id="2å°†mongodbæ–‡ä»¶ç§»åŠ¨åˆ°usrlocalmongodbç›®å½•ä¸‹"><a class="markdownIt-Anchor" href="#2å°†mongodbæ–‡ä»¶ç§»åŠ¨åˆ°usrlocalmongodbç›®å½•ä¸‹"></a> (2).å°†mongoDBæ–‡ä»¶ç§»åŠ¨åˆ°/usr/local/mongodbç›®å½•ä¸‹</h3>
<pre><code>[root@gsunis Desktop]# mv mongodb-linux-x86_64-3.0.6 /usr/local/mongodb
export PATH=/usr/local/mongodb/bin:$PATH
</code></pre>
<h3 id="3æ•°æ®å­˜å‚¨ç›®å½•"><a class="markdownIt-Anchor" href="#3æ•°æ®å­˜å‚¨ç›®å½•"></a> (3).æ•°æ®å­˜å‚¨ç›®å½•</h3>
<pre><code>[root@gsunis bin]# mkdir -p /home/gsunis/data/db
mkdir -p /data/conf 
mkdir -p /data/data1  
mkdir -p /data/data2  
mkdir -p /data/data3  
mkdir -p /data/data4  
mkdir -p /data/data5  
mkdir -p /data/data6 
</code></pre>
<h3 id="4å¯åŠ¨mongodæœåŠ¡"><a class="markdownIt-Anchor" href="#4å¯åŠ¨mongodæœåŠ¡"></a> (4).å¯åŠ¨mongodæœåŠ¡</h3>
<pre><code>[root@gsunis Desktop]# cd /usr/local/mongodb/bin
[root@gsunis bin]# ./mongod --port 27017 --dbpath=/home/gsunis/data/db
</code></pre>
<h3 id="5å¯åŠ¨mongoå®¢æˆ·ç«¯"><a class="markdownIt-Anchor" href="#5å¯åŠ¨mongoå®¢æˆ·ç«¯"></a> (5).å¯åŠ¨mongoå®¢æˆ·ç«¯</h3>
<pre><code>æ‰“å¼€æ–°çš„Terminal
[gsunis@gsunis Desktop]$ su 
æŸ¥çœ‹mongodæœåŠ¡å¯åŠ¨æƒ…å†µ
[root@gsunis Desktop]# netstat -ntpl | grep 27017

[root@gsunis Desktop]# cd /usr/local/mongodb/bin/
[root@gsunis bin]# ./mongo
</code></pre>
<h3 id="6ç¼–è¾‘mongoé…ç½®æ–‡ä»¶"><a class="markdownIt-Anchor" href="#6ç¼–è¾‘mongoé…ç½®æ–‡ä»¶"></a> (6).ç¼–è¾‘mongoé…ç½®æ–‡ä»¶</h3>
<pre><code>sudo vi conf.cnf

//conf.cnf  
rest=true  
port=37017  
dbpath=/home/gsunis/data/conf  
logappend = true  
fork=true  
logpath=/home/gsunis/data/conf/mongodb.log  
nojournal=false  
configsvr=true  
profile=1 

sudo vi db1.cnf

//db1.cnf  
replSet=shard1  
rest=true  
port=47017  
dbpath=/home/gsunis/data/data1  
logappend = true  
fork=true  
logpath=/home/gsunis/data/data1/mongodb.log  
nojournal=false  
shardsvr=true  
profile=1  

sudo vi db2.cnf

//db2.cnf  
replSet=shard2  
rest=true  
port=47018  
dbpath=/home/gsunis/data/data2  
logappend = true  
fork=true  
logpath=/home/gsunis/data/data2/mongodb.log  
nojournal=false  
shardsvr=true  
profile=1  

sudo vi db3.cnf

//db3.cnf  
replSet=shard3  
rest=true  
port=47019  
dbpath=/home/gsunis/data/data3  
logappend = true  
fork=true  
logpath=/home/gsunis/data/data3/mongodb.log  
nojournal=false  
shardsvr=true  
profile=1  

sudo vi db4.cnf

//db4.cnf  
replSet=shard4  
rest=true  
port=47020  
dbpath=/home/gsunis/data/data4  
logappend = true  
fork=true  
logpath=/home/gsunis/data/data4/mongodb.log  
nojournal=false  
shardsvr=true  
profile=1  

sudo vi db5.cnf

//db5.cnf  
replSet=shard5  
rest=true  
port=47021  
dbpath=/home/gsunis/data/data5  
logappend = true  
fork=true  
logpath=/home/gsunis/data/data5/mongodb.log  
nojournal=false  
shardsvr=true  
profile=1  

sudo vi db6.cnf

//db6.cnf  
replSet=shard6  
rest=true  
port=47022  
dbpath=/home/gsunis/data/data6  
logappend = true  
fork=true  
logpath=/home/gsunis/data/data6/mongodb.log  
nojournal=false  
shardsvr=true  
profile=1  
</code></pre>
<h4 id="7ç¼–å†™å¯åŠ¨mongoæœåŠ¡çš„è„šæœ¬"><a class="markdownIt-Anchor" href="#7ç¼–å†™å¯åŠ¨mongoæœåŠ¡çš„è„šæœ¬"></a> (7).ç¼–å†™å¯åŠ¨mongoæœåŠ¡çš„è„šæœ¬</h4>
<pre><code>sudo vi mg.sh

#!/bin/bash  
instance=$1  
action=$2  
case &quot;$action&quot; in  
   'start')  
/usr/local/mongodb/bin/mongod -f /home/gsunis/data/&quot;$instance&quot;.cnf ;;  
   'stop')  
/usr/local/mongodb/bin/mongod -f /home/gsunis/data/&quot;$instance&quot;.cnf --shutdown;;  
   'restart')  
/usr/local/mongodb/bin/mongod -f /home/gsunis/data/&quot;$instance&quot;.cnf --shutdown  
/usr/local/mongodb/bin/mongod -f /home/gsunis/data/&quot;$instance&quot;.cnf;;  
esac  
</code></pre>
<h4 id="8å¯åŠ¨dockerå®ä¾‹çš„mongoæœåŠ¡è„šæœ¬"><a class="markdownIt-Anchor" href="#8å¯åŠ¨dockerå®ä¾‹çš„mongoæœåŠ¡è„šæœ¬"></a> (8).å¯åŠ¨dockerå®ä¾‹çš„mongoæœåŠ¡è„šæœ¬</h4>
<pre><code>sudo vi start.sh

#!/bin/bash 
rm /data/conf/*.lock
rm /data/data1/*.lock	
rm /data/data2/*.lock
rm /data/data3/*.lock
rm /data/data4/*.lock
rm /data/data5/*.lock
rm /data/data6/*.lock
/home/gsunis/data/mg.sh conf start 
/home/gsunis/data/mg.sh db1 start  
/home/gsunis/data/mg.sh db2 start  
/home/gsunis/data/mg.sh db3 start  
/home/gsunis/data/mg.sh db4 start  
/home/gsunis/data/mg.sh db5 start
/home/gsunis/data/mg.sh db6 start  
</code></pre>
<p>sudo vi <a href="http://start.sh" target="_blank" rel="noopener">start.sh</a></p>
<pre><code>#!/bin/bash 
rm /data/conf/*.lock
rm /data/data1/*.lock	
rm /data/data2/*.lock
rm /data/data3/*.lock
rm /data/data4/*.lock
rm /data/data5/*.lock
rm /data/data6/*.lock
/home/gsunis/data/mg.sh conf stop 
/home/gsunis/data/mg.sh db1 stop  
/home/gsunis/data/mg.sh db2 stop  
/home/gsunis/data/mg.sh db3 stop  
/home/gsunis/data/mg.sh db4 stop  
/home/gsunis/data/mg.sh db5 stop
/home/gsunis/data/mg.sh db6 stop  
</code></pre>
<p>æ­£å¸¸å…³é—­mongoDBæœåŠ¡</p>
<pre><code>./mongo
use admin
db.shutdownServer()
</code></pre>
<h3 id="9shardæœåŠ¡å™¨å‰¯æœ¬é›†çš„å»ºç«‹"><a class="markdownIt-Anchor" href="#9shardæœåŠ¡å™¨å‰¯æœ¬é›†çš„å»ºç«‹"></a> (9).shardæœåŠ¡å™¨å‰¯æœ¬é›†çš„å»ºç«‹</h3>
<pre><code>./mongo --port 47017

config = {_id: 'shard1', members: [
 {_id: 0, host: '10.62.0.128:47017'},
 {_id: 1, host: '10.62.0.159:47017'}]
 }
rs.initiate(config)

Ctrl + C é€€å‡º

./mongo --port 47018

config = {_id: 'shard2', members: [
 {_id: 0, host: '10.62.0.128:47018'},
 {_id: 1, host: '10.62.0.159:47018'}]
 }
rs.initiate(config)


./mongo --port 47019

config = {_id: 'shard3', members: [
 {_id: 0, host: '10.62.0.128:47019'},
 {_id: 1, host: '10.62.0.159:47019'}]
 }
rs.initiate(config)


./mongo --port 47020

config = {_id: 'shard4', members: [
 {_id: 0, host: '10.62.0.128:47020'},
 {_id: 1, host: '10.62.0.159:47020'}]
 }
rs.initiate(config)

./mongo --port 47021

config = {_id: 'shard5', members: [
 {_id: 0, host: '10.62.0.128:47021'},
 {_id: 1, host: '10.62.0.159:47021'}]
 }
rs.initiate(config)


./mongo --port 47022

config = {_id: 'shard6', members: [
 {_id: 0, host: '10.62.0.128:47022'},
 {_id: 1, host: '10.62.0.159:47022'}]
 }
rs.initiate(config)
</code></pre>

          
        
      
    </div>
    
    
    

    <div>
          
    </div>

    

    <div>
      
    </div>


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://chetaofeng.github.io/2019/02/14/æ•°æ®åº“-MySQLä¸MariaDBå¯¹æ¯”/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è¡Œé”‹">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/pub-images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è¡Œé”‹">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/14/æ•°æ®åº“-MySQLä¸MariaDBå¯¹æ¯”/" itemprop="url">MySQLä¸MariaDBå¯¹æ¯”</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-02-14T16:22:58+08:00">
                2019-02-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="mysqlä¸mariadbå¯¹æ¯”"><a class="markdownIt-Anchor" href="#mysqlä¸mariadbå¯¹æ¯”"></a> MySQLä¸MariaDBå¯¹æ¯”</h1>
<h2 id="mysql"><a class="markdownIt-Anchor" href="#mysql"></a> MySQLï¼š</h2>
<blockquote>
<p>MySQLæ˜¯ä¸€ä¸ªå…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œç”±ç‘å…¸MySQL AB å…¬å¸å¼€å‘ï¼Œç›®å‰å±äº Oracle æ——ä¸‹äº§å“ã€‚MySQL æ˜¯æœ€æµè¡Œçš„å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿä¹‹ä¸€ï¼Œåœ¨ WEB åº”ç”¨æ–¹é¢ï¼ŒMySQLæ˜¯æœ€å¥½çš„ RDBMS (Relational Database Management Systemï¼Œå…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ) åº”ç”¨è½¯ä»¶ã€‚</p>
</blockquote>
<h2 id="mariadb"><a class="markdownIt-Anchor" href="#mariadb"></a> MariaDB</h2>
<blockquote>
<p>ç”²éª¨æ–‡æ”¶è´­ MySQL åï¼Œç”±äºç”²éª¨æ–‡å¯¹ MySQL çš„å¼€å‘å’Œç»´æŠ¤æ›´å¤šå€¾å‘äºé—­é—¨çš„ç«‹åœºï¼Œå¾ˆå¤š MySQL çš„å¼€å‘è€…å’Œç”¨æˆ·æ”¾å¼ƒäº†å®ƒã€‚åœ¨ç¤¾åŒºé©±åŠ¨ä¸‹ï¼Œä¿ƒä½¿æ›´å¤šäººç§»åˆ° MySQL çš„å¦ä¸€ä¸ªå« MariaDB çš„åˆ†æ”¯ï¼Œåœ¨åŸæœ‰ MySQL å¼€å‘äººå‘˜çš„å¸¦é¢†ä¸‹ï¼ŒMariaDB çš„å¼€å‘éµå¾ªå¼€æºçš„ç†å¿µï¼Œå¹¶ç¡®ä¿å®ƒçš„äºŒè¿›åˆ¶æ ¼å¼ä¸ MySQL å…¼å®¹ã€‚</p>
</blockquote>

          
        
      
    </div>
    
    
    

    <div>
          
    </div>

    

    <div>
      
    </div>


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://chetaofeng.github.io/2019/02/14/æ•°æ®åº“-2018-12-10-MongoDB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è¡Œé”‹">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/pub-images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è¡Œé”‹">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/14/æ•°æ®åº“-2018-12-10-MongoDB/" itemprop="url">MongoDB</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-02-14T16:22:58+08:00">
                2019-02-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/æ•°æ®åº“/" itemprop="url" rel="index">
                    <span itemprop="name">æ•°æ®åº“</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://www.jikexueyuan.com/course/mongoDB/" target="_blank" rel="noopener">https://www.jikexueyuan.com/course/mongoDB/</a></p>
<p>NoSQLæ•°æ®åº“ï¼šNoSQL(NoSQL = Not Only SQL )ï¼Œæ„å³&quot;ä¸ä»…ä»…æ˜¯SQL&quot;ï¼ŒæŒ‡çš„æ˜¯éå…³ç³»å‹çš„æ•°æ®åº“</p>
<p>mongodbå®˜ç½‘ï¼š<a href="https://www.mongodb.com/" target="_blank" rel="noopener">https://www.mongodb.com/</a><br>
<a href="https://docs.mongodb.com/manual/" target="_blank" rel="noopener">https://docs.mongodb.com/manual/</a></p>
<p>MongoDBæ˜¯ä¸€ä¸ªåŸºäºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„æ•°æ®åº“ã€‚ç”±C++è¯­è¨€ç¼–å†™ã€‚æ—¨åœ¨ä¸ºWEBåº”ç”¨æä¾›å¯æ‰©å±•çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚<br>
MongoDBæ˜¯ä¸€ä¸ªä»‹äºå…³ç³»æ•°æ®åº“å’Œéå…³ç³»æ•°æ®åº“ä¹‹é—´çš„äº§å“ï¼Œæ˜¯éå…³ç³»æ•°æ®åº“å½“ä¸­åŠŸèƒ½æœ€ä¸°å¯Œï¼Œæœ€åƒå…³ç³»æ•°æ®åº“çš„ã€‚</p>
<p><a href="http://www.runoob.com/mongodb/mongodb-tutorial.html" target="_blank" rel="noopener">http://www.runoob.com/mongodb/mongodb-tutorial.html</a></p>
<p>NoSQLä¿è¯æ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§ï¼Œæ•°æ®ç”±æ›´æ–°å»¶è¿Ÿ</p>
<p>CAPç†è®º</p>
<p>é€‚ç”¨åœºæ™¯ï¼šæ•°æ®ç¼“å­˜ï¼›jsonæ ¼å¼æ•°æ®å­˜å‚¨ï¼›é«˜ä¼¸ç¼©æ€§åœºæ™¯ï¼›<br>
MongoDBæ›´å¤šé€‚åˆå¤§æ•°æ®é‡ã€é«˜å¹¶å‘ã€å¼±äº‹åŠ¡çš„äº’è”ç½‘åº”ç”¨ï¼Œå…¶å†…ç½®çš„æ°´å¹³æ‰©å±•æœºåˆ¶æä¾›äº†ä»å‡ ç™¾ä¸‡åˆ°åäº¿çº§åˆ«çš„æ•°æ®å¤„ç†èƒ½åŠ›ï¼Œå¯å¾ˆå¥½çš„æ»¡è¶³Web2.0å’Œç§»åŠ¨äº’è”ç½‘åº”ç”¨çš„sæ•°æ®å­˜å‚¨è¦æ±‚ã€‚</p>
<p>MongoDBç”±C++ç¼–å†™ï¼Œæ”¯æŒ32ä½ï¼ˆ2Gé™åˆ¶ï¼‰å’Œ64ä½åº”ç”¨ï¼Œæ˜¯ä¸€ä¸ªåŸºäºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„å¼€æºæ•°æ®åº“ç³»ç»Ÿã€‚</p>
<p>MongoDB3.0ç‰¹æ€§ï¼š</p>
<ol>
<li>åŠ å…¥WiredTigerå­˜å‚¨å¼•æ“:<br>
å¼€æºçš„å­˜å‚¨å¼•æ“ï¼›ä¸ºç°ä»£ç¡¬ä»¶è®¾è®¡ï¼šå¤šæ ¸CPUï¼Œå……åˆ†åˆ©ç”¨å†…å­˜ï¼èŠ¯ç‰‡çº§ç¼“å­˜ï¼›RAM/SSD/HDDï¼›ä¸ºå¤§æ•°æ®è®¾è®¡ï¼šé«˜æ€§èƒ½ï¼Œä½å»¶è¿Ÿï¼Œé«˜å¹¶å‘ç¨³å®šæ€§</li>
<li>MMAPv1:å†…å­˜æ˜ å°„å­˜å‚¨å¼•æ“ï¼Œä¸ºé»˜è®¤å¼•æ“ ï¼Œæä¾›äº†Collectioné”ï¼›æ— ç¼è¿ç§»MMAP</li>
<li>å¯æ’æ‹”å¼•æ“API</li>
<li>åŸºäºWebçš„å¯è§†åŒ–ç®¡ç†å·¥å…·ï¼šOps Manager</li>
</ol>
<p>MongoDBæ•°æ®æ¨¡å‹<br>
æ–‡æ¡£ï¼šæœ¬è´¨ä¸Šæ˜¯ä¸€ç§ç±»JSONçš„BSONæ ¼å¼çš„æ•°æ®ï¼Œå¯ä»¥ç†è§£ä¸ºåœ¨JSONåŸºç¡€ä¸Šæ·»åŠ äº†ä¸€äº›æ–°çš„æ•°æ®ç±»å‹ï¼ŒåŒ…æ‹¬Dateï¼Œæ­£åˆ™è¡¨è¾¾å¼ç­‰ã€‚<br>
BSONå®˜ç½‘ï¼š<a href="http://bsonspec.org/" target="_blank" rel="noopener">http://bsonspec.org/</a><br>
BSONæ˜¯ç”±ä¸€ç»„ç»„é”®å€¼å¯¹ç»„æˆï¼Œå…·æœ‰è½»é‡æ€§ã€å¯é æ€§å’Œé«˜æ•ˆæ€§3ä¸ªç‰¹å¾ã€‚å¯éå†æ€§æ˜¯MongoDBå°†BSONä½œä¸ºæ•°æ®å­˜å‚¨çš„é‡è¦åŸå› <br>
ä½¿ç”¨æ–‡æ¡£æ—¶éœ€è¦æ³¨æ„ä»¥ä¸‹äº‹é¡¹ï¼š<br>
MongoDBä¸­å†™æ“ä½œçš„åŸå­æ€§é™åˆ¶åœ¨æ–‡æ¡£çº§åˆ«ï¼›<br>
å•ä¸ªæ–‡æ¡£å ç”¨çš„å­˜å‚¨ç©ºé—´ä¸èƒ½è¶…è¿‡16MBï¼›<br>
MongoDBä¼šå°½é‡ä¿æŒæ–‡æ¡£è¢«æ’å…¥æ—¶é”®å€¼å¯¹çš„é¡ºåºï¼›<br>
å…³äºæ–‡æ¡£å‘½åéœ€è¦æ³¨æ„çš„äº‹é¡¹ï¼š<br>
_idæ˜¯ç³»ç»Ÿä¿ç•™çš„å…³é”®å­—ï¼Œä»–æ˜¯é»˜è®¤çš„ä¸»é”®ï¼Œè¯¥å€¼åœ¨é›†åˆä¸­å¿…é¡»å”¯ä¸€ï¼Œä¸”ä¸å¯æ›´æ”¹ï¼›<br>
é”®ä¸èƒ½åŒ…å«ç©ºå­—ç¬¦æˆ–\0ï¼Œè¿™ä¸ªå­—ç¬¦ç”¨äºè¡¨ç¤ºé”®çš„ç»“å°¾ï¼›<br>
ä¸èƒ½ä»¥$å¼€å¤´ä¸”ä¸èƒ½åŒ…å«ç‚¹å·.<br>
é”®æ˜¯åŒºåˆ†å¤§å°å†™çš„ä¸”ä¸èƒ½é‡å¤</p>
<p>é›†åˆï¼šæŠŠä¸€ç»„ç›¸å…³çš„æ–‡æ¡£æ”¾åˆ°ä¸€èµ·ç»„æˆäº†é›†åˆï¼ŒMongoDBçš„é›†åˆæ˜¯æ¨¡å¼è‡ªç”±çš„ï¼Œä¸€ä¸ªé›†åˆé‡Œé¢çš„æ–‡æ¡£å¯ä»¥æ˜¯å„å¼å„æ ·çš„<br>
MogoDBæä¾›äº†ä¸€äº›ç‰¹æ®Šçš„é›†åˆï¼šcapped collectionã€system.indexesã€system.namespacesç­‰<br>
é›†åˆå‘½åéœ€æ³¨æ„ï¼š<br>
é›†åˆåä¸èƒ½æ˜¯ç©ºå­—ç¬¦ä¸²ï¼›<br>
é›†åˆåä¸èƒ½åŒ…å«ç©ºå­—ç¬¦ä¸²æˆ–\0ï¼Œè¯¥å­—ç¬¦è¡¨ç¤ºé›†åˆåçš„ç»“å°¾<br>
é›†åˆåä¸èƒ½ä»¥&quot;system.&quot;å¼€å¤´ï¼Œæ­¤å‰ç¼€æ˜¯ç³»ç»Ÿæœ¬èº«ä¿ç•™çš„<br>
é›†åˆåä¸èƒ½åŒ…å«$å­—ç¬¦ï¼Œä½†æ˜¯å¯ä»¥åŒ…å«ç‚¹å·.</p>
<p>æ•°æ®åº“ï¼šå¤šä¸ªæ–‡æ¡£ç»„æˆé›†åˆï¼Œå¤šä¸ªé›†åˆç»„æˆæ•°æ®åº“ã€‚ä¸€ä¸ªMongoDBå®ä¾‹å¯æ‰¿è½½å¤šä¸ªæ•°æ®åº“ï¼Œæ¯ä¸ªæ•°æ®åº“æœ‰ç‹¬ç«‹çš„æƒé™ï¼Œåœ¨ç£ç›˜ä¸Šï¼Œä¸åŒçš„æ•°æ®åº“ä¹Ÿå¯æ”¾ç½®åˆ°ä¸é€šç›®å½•<br>
æ•°æ®åº“å‘½åè§„åˆ™ï¼š<br>
ä¸èƒ½æ˜¯ç©ºå­—ç¬¦ä¸²ï¼›ä¸èƒ½ä»¥$å¼€å¤´ï¼›ä¸èƒ½åŒ…å«ç©ºå­—ç¬¦ä¸²å’Œç‚¹å·.;æ•°æ®åº“åç§°åŒºåˆ†å¤§å°å†™ï¼›å»ºè®®æ•°æ®åº“åå…¨éƒ¨ä½¿ç”¨å°å†™ï¼›æ•°æ®åº“åæœ€é•¿64å­—èŠ‚ï¼›ä¸è¦ä¸ç³»ç»Ÿä¿ç•™æ•°æ®åº“åç›¸åŒ</p>
<p>å‘½åç©ºé—´ï¼šæŠŠæ•°æ®åº“åæ·»åŠ åˆ°é›†åˆåå‰é¢ï¼Œä¸­é—´ç”¨ç‚¹å·è¿æ¥ï¼Œå¾—åˆ°é›†åˆçš„å®Œå…¨é™å®šï¼Œå°±æ˜¯å‘½åç©ºé—´<br>
å› ä¸ºç‚¹å·å¯ä»¥å‡ºç°åœ¨é›†åˆåå­—ä¸­ï¼Œå¦‚ï¼šjike.blog.posts å’Œ jike.blog.authorsï¼Œå¯ä»¥å°†postså’Œauthorsçœ‹ä½œæ˜¯blogé›†åˆçš„å­é›†åˆï¼Œblogé›†åˆç”šè‡³å¯ä»¥ä¸å­˜åœ¨<br>
ä½¿ç”¨å­é›†åˆçš„æ–¹å¼ï¼Œå¯ä»¥æ˜¯æˆ‘ä»¬æ›´å¥½çš„ç»„ç»‡æ•°æ®ï¼Œä½¿æ•°æ®ç»“æ„æ›´åŠ æ¸…æ™°æ˜äº†</p>
<p>MongoDBæ•°æ®ç±»å‹<br>
åŸºæœ¬æ•°æ®ç±»å‹<br>
nullï¼šè¡¨ç¤ºç©ºå€¼æˆ–è€…ä¸å­˜åœ¨çš„å­—æ®µ<br>
å¸ƒå°”ï¼štrueï¼false<br>
æ•°æ®ç±»å‹ï¼š32-int,64-int,64-double,æ³¨æ„ï¼šJavaScriptåªæ”¯æŒ64ä½æµ®ç‚¹æ•°<br>
å­—ç¬¦ä¸²ç±»å‹ï¼šä½¿ç”¨UTF-8å¯¹å­—ç¬¦ä¸²è¿›è¡Œç¼–ç <br>
äºŒè¿›åˆ¶æ•°æ®ï¼šå¯ä»¥ä¿å­˜ç”±ä»»æ„å­—èŠ‚ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œå¦‚ï¼šå›¾ç‰‡ã€è§†é¢‘ç­‰<br>
æ­£åˆ™è¡¨è¾¾å¼ç±»å‹ï¼šä¸»è¦ç”¨äºæŸ¥è¯¢ï¼Œä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ä½œä¸ºé™å®šæ¡ä»¶<br>
Dateç±»å‹ï¼šæ˜¯ä¸€ä¸ª64ä½æ•´æ•°ï¼Œå®ƒä»£è¡¨è·Unix epochï¼š1970-1-1çš„æ¯«ç§’æ•°ï¼ŒMongoDBåœ¨å­˜å‚¨æ—¶é—´æ˜¯ç°è½¬æ¢ä¸ºUTCæ—¶é—´ï¼ŒåŒ—äº¬æ—¶é—´=UTC+8å°æ—¶ï¼ŒMongoDB Shellä¼šæ ¹æ®æœ¬åœ°æ—¶é—´ è®¾ç½®æ˜¾ç¤ºæ—¥æœŸæ—¶é—´<br>
Timestapï¼š32bit Unix epoch + 32bitè‡ªå¢åºæ•°ï¼Œåªä¾›MongoDBæ•°æ®åº“æœåŠ¡å†…éƒ¨ä½¿ç”¨ï¼Œç”¨äºè®°å½•æ“ä½œçš„è¯¦ç»†æ—¶é—´<br>
ObjectIdï¼šç”±24ä¸ª16ç²¾åˆ¶å­—ç¬¦ç»„æˆï¼Œæ¯ä¸ªå­—èŠ‚å­˜å‚¨ä¸¤ä½16ç²¾åˆ¶æ•°å­—ï¼Œæ€»å…±éœ€12å­—èŠ‚å­˜å‚¨ç©ºé—´=4å­—èŠ‚æ—¶é—´æˆ³+3å­—èŠ‚æœºå™¨æ ‡è¯†+2å­—èŠ‚pid+3å­—èŠ‚è®¡æ•°å™¨ï¼ŒObjectId(),getTimestamp(),valueOf()<br>
æ•°ç»„ï¼šä½¿ç”¨æ–¹æ‹¬å·æ¥è¡¨ç¤ºçš„ä¸€ç»„å€¼ï¼Œæ•°ç»„ä¸­å¯ä»¥åŒ…å«ä¸é€šæ•°æ®ç±»å‹çš„å…ƒç´ ï¼Œé’ˆå¯¹æ•°ç»„ï¼ŒMongoDBæä¾›äº†è®¸å¤šæ“ä½œç¬¦ï¼Œå¦‚ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mi>o</mi><mi>p</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">pop,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">o</span><span class="mord mathdefault">p</span><span class="mpunct">,</span></span></span></span>push,<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mi>u</mi><mi>l</mi><mi>l</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">pull,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">u</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span></span></span></span>slice,$addToSetç­‰ï¼›MongoDBå¯è‡ªåŠ¨ä¸ºæ•°ç»„å…ƒç´ å»ºç«‹MultiKeyç´¢å¼•<br>
å†…åµŒæ–‡æ¡£ï¼šæ–‡æ¡£å¯ä»¥ä½œä¸ºé”®çš„å€¼ï¼Œè¿™æ ·çš„æ–‡æ¡£æˆä¸ºå†…åµŒæ–‡æ¡£ã€‚å†…åµŒæ–‡æ¡£å¯ä»¥ä½¿æ•°æ®ä¸ç”¨ä¿å­˜æˆæ‰å¹³ç»“æœçš„é”®å€¼å¯¹ï¼Œä»è€Œä½¿æ•°æ®ç»„ç»‡å½¢å¼æ›´åŠ è‡ªç„¶ã€‚</p>
<p>å†…åµŒæ–‡æ¡£æ¨¡å¼VSå¼•ç”¨æ–‡æ¡£æ¨¡å¼<br>
å­æ–‡æ¡£æ¯”è¾ƒå°æˆ–å˜åŒ–ä¸é¢‘ç¹ï¼Œåˆ™ä½¿ç”¨å†…åµŒæ–‡æ¡£æ¨¡å¼ï¼Œå¦åˆ™ä½¿ç”¨å¼•ç”¨æ–‡æ¡£æ¨¡å¼</p>
<p>MongoDBè‡ªåŠ¨å°†_idå­—æ®µè®¾ç½®ä¸ºä¸»é”®</p>
<p>MongoDB Shellï¼šæ˜¯MongoDBè‡ªå¸¦çš„JavaScript Shellï¼ŒéšMongoDBä¸€èµ·å‘å¸ƒ =JavaScript V8è§£é‡Šå™¨+MongoDBå®¢æˆ·ç«¯</p>
<p>helpæŸ¥çœ‹å¸®åŠ©<br>
æ‰§è¡Œè„šæœ¬<br>
ç›´æ¥æ‰§è¡Œï¼šmongo [â€“quiet] script.js<br>
äº¤äº’æ‰§è¡Œï¼šload(â€œscript.jsâ€)<br>
æ‰§è¡Œå‘½ä»¤è¡Œç¨‹åºï¼šrun(â€œlsâ€)<br>
.mongorc.jsæ–‡ä»¶ï¼Œé»˜è®¤ä¼šåŠ è½½<br>
ç¼–è¾‘å¤åˆå˜é‡EDITORï¼šåœ¨.bashrcä¸­æ·»åŠ åsourceç”Ÿæ•ˆ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#EDITOR</span><br><span class="line">EDITOR=/usr/bin/vim</span><br></pre></td></tr></table></figure>
<p>å³å¯ä½¿ç”¨editorç¼–è¾‘æ–‡æ¡£</p>
<p><a href="http://www.runoob.com/mongodb/mongodb-intro.html" target="_blank" rel="noopener">http://www.runoob.com/mongodb/mongodb-intro.html</a><br>
Mongodbä¸­çš„Map/reduceä¸»è¦æ˜¯ç”¨æ¥å¯¹æ•°æ®è¿›è¡Œæ‰¹é‡å¤„ç†å’Œèšåˆæ“ä½œã€‚<br>
GridFSæ˜¯MongoDBä¸­çš„ä¸€ä¸ªå†…ç½®åŠŸèƒ½ï¼Œå¯ä»¥ç”¨äºå­˜æ”¾å¤§é‡å°æ–‡ä»¶ã€‚<br>
MongoDBå…è®¸åœ¨æœåŠ¡ç«¯æ‰§è¡Œè„šæœ¬ï¼Œå¯ä»¥ç”¨Javascriptç¼–å†™æŸä¸ªå‡½æ•°ï¼Œç›´æ¥åœ¨æœåŠ¡ç«¯æ‰§è¡Œï¼Œä¹Ÿå¯ä»¥æŠŠå‡½æ•°çš„å®šä¹‰å­˜å‚¨åœ¨æœåŠ¡ç«¯ï¼Œä¸‹æ¬¡ç›´æ¥è°ƒç”¨å³å¯ã€‚</p>
<p>MongoDBæ•°æ®åº“å®‰è£…ï¼š</p>
<ol>
<li>ä¸‹è½½å®‰è£…æ–‡ä»¶è§£å‹ç¼©å¹¶æ·»åŠ binç›®å½•åˆ°ç¯å¢ƒå˜é‡</li>
<li>åˆ›å»ºä¸€ä¸ªdataç›®å½•ï¼Œç„¶ååœ¨dataç›®å½•é‡Œåˆ›å»ºdbç›®å½•ã€logsç›®å½•</li>
<li>å¯åŠ¨æœåŠ¡ç«¯</li>
<li>å¯åŠ¨å®¢æˆ·ç«¯ï¼šmongo</li>
<li>windowsä¸‹å¯ä»¥å°†MongoDBåšæˆç³»ç»ŸæœåŠ¡</li>
</ol>
<p>mac<br>
ä¸´æ—¶æ·»åŠ ç¯å¢ƒå˜é‡ï¼šexport PATH=/usr/local/mongodb/bin:<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mi>A</mi><mi>T</mi><mi>H</mi><mi mathvariant="normal">ç¼–</mi><mi mathvariant="normal">è¾‘</mi><mtext>Â </mtext><mi mathvariant="normal">/</mi><mi mathvariant="normal">.</mi><mi>b</mi><mi>a</mi><mi>s</mi><msub><mi>h</mi><mi>p</mi></msub><mi>r</mi><mi>o</mi><mi>f</mi><mi>i</mi><mi>l</mi><mi>e</mi><mo separator="true">,</mo><mi mathvariant="normal">æ·»</mi><mi mathvariant="normal">åŠ </mi><mi mathvariant="normal">ï¼š</mi><mi>e</mi><mi>x</mi><mi>p</mi><mi>o</mi><mi>r</mi><mi>t</mi><mi>P</mi><mi>A</mi><mi>T</mi><mi>H</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">PATH
ç¼–è¾‘~/.bash_profile,æ·»åŠ ï¼šexport PATH=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord cjk_fallback">ç¼–</span><span class="mord cjk_fallback">è¾‘</span><span class="mspace nobreak">Â </span><span class="mord">/</span><span class="mord">.</span><span class="mord mathdefault">b</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">æ·»</span><span class="mord cjk_fallback">åŠ </span><span class="mord cjk_fallback">ï¼š</span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span></span>PATH:/usr/local/mongodb4/bin/:$PATH å³å¯æ°¸ä¹…æ·»åŠ ç¯å¢ƒå˜é‡</p>
<p>è¿æ¥MongoDBæ•°æ®åº“ï¼š./mongo + æœåŠ¡å™¨IP:ç«¯å£å·/æ•°æ®åº“å<br>
å…³é—­MongoDBæœåŠ¡åœ¨ ./mongo è¿›å…¥æ§åˆ¶å°åï¼Œè¾“å…¥ use admin,ç„¶åè¾“å…¥ db.shutdownServer()</p>
<p>Mongodbå¯ä»¥é€šè¿‡å‘½ä»¤è¡Œæ–¹å¼å’Œé…ç½®æ–‡ä»¶çš„æ–¹å¼æ¥å¯åŠ¨ï¼š<br>
è¿™ä¸¤ç§æ–¹å¼éƒ½æ˜¯åœ¨å‰å°å¯åŠ¨Mongodbè¿›ç¨‹ï¼Œå¦‚æœSessionçª—å£å…³é—­ï¼ŒMongodbè¿›ç¨‹ä¹Ÿéšä¹‹åœæ­¢ã€‚<br>
ä¸è¿‡MongodbåŒæ—¶è¿˜æä¾›äº†ä¸€ç§åå°Daemonæ–¹å¼å¯åŠ¨ï¼Œåªéœ€è¦åŠ ä¸Šä¸€ä¸ª&quot;â€“fork&quot;å‚æ•°å³å¯ï¼Œç”¨åˆ°äº†&quot;â€“fork&quot;å‚æ•°å°±å¿…é¡»å¯ç”¨&quot;â€“logpath&quot;å‚æ•°<br>
é€šè¿‡å‘½ä»¤è¡Œï¼š ./bin/mongod --dbpath=/data/db --fork --logpath=/data/logs/mongodb.log<br>
é…ç½®æ–‡ä»¶æ–¹å¼ï¼š./bin/mongod -f mongodb.conf  æˆ– ./bin/mongod --config mongodb.conf  //-f åé¢å†™è¦ä½¿ç”¨çš„é…ç½®æ–‡ä»¶<br>
./bin/mongod --shutdown -f mongod.conf</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">port=27017</span><br><span class="line">dbpath=/usr/local/mongodb/data/</span><br><span class="line">logpath=/usr/local/mongodb/log/mongodb.log  </span><br><span class="line">fork = true</span><br></pre></td></tr></table></figure>
<p>å‘½ä»¤è¡Œæ“ä½œï¼š<br>
use mytetDB  //æ•°æ®åº“å¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»º<br>
saveæ—¶å¦‚æœç»™å®šäº†_ObjectIdåˆ™æ›´æ–°åˆ›å»ºæ•´æ¡è®°å½•ï¼›å¦‚æœè¦æ›´æ–°éƒ¨åˆ†å­—æ®µåˆ™ä½¿ç”¨updateæ–¹æ³•ä½¿ç”¨$set<br>
db.dropDatabase()<br>
db//æ˜¾ç¤ºå½“å‰æ•°æ®åº“<br>
show dbs<br>
show collections</p>
<p>æœ‰ä¸€äº›æ•°æ®åº“åæ˜¯ä¿ç•™çš„ï¼Œå¯ä»¥ç›´æ¥è®¿é—®è¿™äº›æœ‰ç‰¹æ®Šä½œç”¨çš„æ•°æ®åº“ã€‚<br>
adminï¼š ä»æƒé™çš„è§’åº¦æ¥çœ‹ï¼Œè¿™æ˜¯&quot;root&quot;æ•°æ®åº“ã€‚è¦æ˜¯å°†ä¸€ä¸ªç”¨æˆ·æ·»åŠ åˆ°è¿™ä¸ªæ•°æ®åº“ï¼Œè¿™ä¸ªç”¨æˆ·è‡ªåŠ¨ç»§æ‰¿æ‰€æœ‰æ•°æ®åº“çš„æƒé™ã€‚ä¸€äº›ç‰¹å®šçš„æœåŠ¡å™¨ç«¯å‘½ä»¤ä¹Ÿåªèƒ½ä»è¿™ä¸ªæ•°æ®åº“è¿è¡Œï¼Œæ¯”å¦‚åˆ—å‡ºæ‰€æœ‰çš„æ•°æ®åº“æˆ–è€…å…³é—­æœåŠ¡å™¨ã€‚<br>
local: è¿™ä¸ªæ•°æ®æ°¸è¿œä¸ä¼šè¢«å¤åˆ¶ï¼Œå¯ä»¥ç”¨æ¥å­˜å‚¨é™äºæœ¬åœ°å•å°æœåŠ¡å™¨çš„ä»»æ„é›†åˆ<br>
config: å½“Mongoç”¨äºåˆ†ç‰‡è®¾ç½®æ—¶ï¼Œconfigæ•°æ®åº“åœ¨å†…éƒ¨ä½¿ç”¨ï¼Œç”¨äºä¿å­˜åˆ†ç‰‡çš„ç›¸å…³ä¿¡æ¯ã€‚</p>
<p>MongoDB GridFSæ–‡ä»¶ç³»ç»Ÿ<br>
åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼šå°†å›ºå®šå­˜å‚¨äºå•å°æœºå™¨ä¸Šçš„æ–‡ä»¶ç³»ç»Ÿï¼Œæ‰©å±•åˆ°å¤šå°æœºå™¨ä¸Šï¼Œæ¯ä¸ªèŠ‚ç‚¹è´Ÿè´£å­˜å‚¨éƒ¨åˆ†æ•°æ®ï¼Œä¼—å¤šçš„å­˜å‚¨èŠ‚ç‚¹ç»„æˆä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿç½‘ç»œï¼Œå„ä¸ªèŠ‚ç‚¹é€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡å’Œæ•°æ®ä¼ è¾“</p>
<p>å½“å­˜å‚¨æ–‡æ¡£å¤§äº16Mæ—¶ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨GridFS<br>
GridFSï¼šæ˜¯MongoDBåˆ¶å®šçš„å¦‚ä½•åœ¨æ•°æ®åº“ä¸­å­˜å‚¨å¤§æ–‡ä»¶çš„è§„èŒƒï¼ŒMongoDBå¹¶æ²¡æœ‰å®ç°GridFSï¼Œè€Œæ˜¯äº¤ç”±å®¢æˆ·ç«¯é©±åŠ¨ç¨‹åºå®ç°<br>
GridFSä½¿ç”¨ä¸¤ä¸ªé›†åˆï¼ˆcollectionï¼‰å­˜å‚¨æ–‡ä»¶ã€‚ä¸€ä¸ªé›†åˆæ˜¯chunks, ç”¨äºå­˜å‚¨æ–‡ä»¶å†…å®¹çš„äºŒè¿›åˆ¶æ•°æ®ï¼›ä¸€ä¸ªé›†åˆæ˜¯filesï¼Œç”¨äºå­˜å‚¨æ–‡ä»¶çš„å…ƒæ•°æ®ã€‚<br>
ä½¿ç”¨fs.fileså­˜å‚¨æ–‡ä»¶çš„å…ƒæ•°æ®ï¼ŒåŒ…å«å­—æ®µå¦‚ä¸‹ï¼š<br>
ä½¿ç”¨fs.chunkså­˜å‚¨ä»¥255Kè¿›è¡Œåˆ†å‰²çš„æ–‡ä»¶å—ï¼ŒåŒ…å«å­—æ®µå¦‚ä¸‹ï¼š<br>
GridFSé€‚ç”¨äºå¦‚ä¸‹åœºæ™¯ï¼š<br>
å­˜å‚¨ç”¨æˆ·äº§ç”Ÿçš„æ–‡ä»¶ä¸”æ–‡ä»¶æ•°é‡æ¯”è¾ƒå¤§ï¼›éœ€è¦æ–‡ä»¶çš„è‡ªåŠ¨å¤‡ä»½å’Œåˆ†å¸ƒå¼å­˜å‚¨ï¼›éœ€è¦è®¿é—®æ–‡ä»¶çš„éƒ¨åˆ†å†…å®¹ï¼›å­˜å‚¨16MBä»¥ä¸Šçš„æ–‡ä»¶<br>
mongofilesæ˜¯MongoDBå®‰è£…åŒ…ä¸­æä¾›çš„ä¸€ä¸ªå·¥å…·ï¼Œä¸“é—¨ç”¨æ¥å­˜å–æ–‡ä»¶ï¼ŒåŒ…æ‹¬æŸ¥è¯¢æ‰€æœ‰æ–‡ä»¶ã€æŸ¥çœ‹æ–‡ä»¶ã€ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ã€è·å–ä¸€ä¸ªæ–‡ä»¶ã€æŒ‰ç…§_idæ¥è·å–æ–‡ä»¶ã€æŒ‰æ–‡ä»¶ååˆ é™¤æ–‡ä»¶ã€æŒ‰_idåˆ é™¤æ–‡ä»¶ã€‚<br>
mongofiles --helpå…¶å®æœ‰å››ä¸ªä¸»è¦å‘½ä»¤ï¼Œåˆ†åˆ«ä¸ºï¼š<br>
put â€”å­˜å‚¨å‘½ä»¤<br>
get â€”è·å–å‘½ä»¤<br>
list â€”åˆ—è¡¨å‘½ä»¤<br>
delete â€”åˆ é™¤å‘½ä»¤</p>
<p>MongoDBèšåˆç®¡é“ï¼šèšåˆæ“ä½œä¸»è¦ç”¨æˆ·æ‰¹é‡æ•°æ®å¤„ç†ï¼Œå¾€å¾€å°†è®°å½•æŒ‰æ¡ä»¶åˆ†ç»„ï¼Œç„¶ååœ¨æ¯ç»„ä¸Šåˆ†åˆ«è¿›è¡Œä¸€ç³»åˆ—æ“ä½œï¼Œå¦‚ï¼šæ±‚å’Œã€æ±‚æœ€å¤§å°å€¼ç­‰<br>
èšåˆæ“ä½œèƒ½å¤Ÿå¯¹è®°å½•è¿›è¡Œå¤æ‚å¤„ç†ï¼Œä¸»è¦ä¸ºæ•°ç†ç»Ÿè®¡å’Œæ•°æ®æŒ–æ˜ã€‚<br>
MongoDBæä¾›äº†3ç§èšåˆæ“ä½œæ–¹å¼ï¼š<br>
èšåˆç®¡é“ï¼ˆAggregation Pipelineï¼‰:MongoDB Shellä½¿ç”¨db.collection.aggregate([{â€¦}])æ¥æ„å»ºå’Œä½¿ç”¨èšåˆç®¡é“<br>
$project:ç”¨äºä¿®æ”¹æ–‡æ¡£çš„ç»“æ„ï¼Œå¯ä»¥é‡å‘½åã€å¢åŠ æˆ–åˆ é™¤æ–‡æ¡£å­—æ®µ<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mo>:</mo><mi mathvariant="normal">ç”¨</mi><mi mathvariant="normal">äº</mi><mi mathvariant="normal">è¿‡</mi><mi mathvariant="normal">æ»¤</mi><mi mathvariant="normal">æ–‡</mi><mi mathvariant="normal">æ¡£</mi><mi mathvariant="normal">ï¼Œ</mi><mi mathvariant="normal">åœ¨</mi></mrow><annotation encoding="application/x-tex">match:ç”¨äºè¿‡æ»¤æ–‡æ¡£ï¼Œåœ¨</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0em;vertical-align:0em;"></span><span class="mord cjk_fallback">ç”¨</span><span class="mord cjk_fallback">äº</span><span class="mord cjk_fallback">è¿‡</span><span class="mord cjk_fallback">æ»¤</span><span class="mord cjk_fallback">æ–‡</span><span class="mord cjk_fallback">æ¡£</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">åœ¨</span></span></span></span>matchä¸­ä¸èƒ½ä½¿ç”¨$where,å°½é‡å‡ºç°åœ¨ç®¡é“çš„å‰é¢ï¼Œæ–¹ä¾¿å€ŸåŠ©ç´¢å¼•åŠ å¿«æŸ¥è¯¢<br>
$group:å°†é›†åˆä¸­çš„æ–‡æ¡£è¿›è¡Œåˆ†ç»„ï¼Œæ­¤åˆ†ç»„åœ¨å†…å­˜ä¸­è¿›è¡Œï¼Œæœ€å¤§100Mï¼Œå¯é€šè¿‡allowDiskUseå¯ç”¨ç£ç›˜äº¤æ¢å¤„ç†<br>
$sort:å°†é›†åˆä¸­çš„æ–‡æ¡£è¿›è¡Œæ’åºï¼Œæ­¤åˆ†ç»„åœ¨å†…å­˜ä¸­è¿›è¡Œï¼Œæœ€å¤§100Mï¼Œå¯é€šè¿‡allowDiskUseå¯ç”¨ç£ç›˜äº¤æ¢å¤„ç†<br>
$skip:è·³è¿‡æŒ‡å®šæ•°é‡çš„æ–‡æ¡£<br>
$unwind:å°†æ–‡æ¡£æŒ‰ç…§æ•°ç»„å­—æ®µæ‹†åˆ†æˆå¤šæ¡æ–‡æ¡£ï¼Œæ¯æ¡æ–‡æ¡£åŒ…å«æ•°ç»„çš„ä¸€ä¸ªå…ƒç´ <br>
$geoNear:æŒ‰ç…§ç”±è¿‘åˆ°è¿œé¡ºåºè¾“å‡ºæ¥è¿‘æŸä¸€åœ°ç†ä½ç½®çš„æ–‡æ¡£<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mo>:</mo><mi mathvariant="normal">å°†</mi><mi mathvariant="normal">èš</mi><mi mathvariant="normal">åˆ</mi><mi mathvariant="normal">ç»“</mi><mi mathvariant="normal">æœ</mi><mi mathvariant="normal">å­˜</mi><mi mathvariant="normal">å‚¨</mi><mi mathvariant="normal">åˆ°</mi><mi mathvariant="normal">é›†</mi><mi mathvariant="normal">åˆ</mi><mi mathvariant="normal">ä¸­</mi><mi mathvariant="normal">ï¼Œ</mi><mi mathvariant="normal">å‚</mi><mi mathvariant="normal">æ•°</mi><mi mathvariant="normal">ä¸º</mi><mi mathvariant="normal">é›†</mi><mi mathvariant="normal">åˆ</mi><mi mathvariant="normal">å</mi><mi mathvariant="normal">ç§°</mi><mi mathvariant="normal">ã€‚</mi><mi mathvariant="normal">ã€‚</mi><mi mathvariant="normal">ã€‚</mi><mi mathvariant="normal">èš</mi><mi mathvariant="normal">åˆ</mi><mi mathvariant="normal">ç®¡</mi><mi mathvariant="normal">é“</mi><mi mathvariant="normal">è¡¨</mi><mi mathvariant="normal">è¾¾</mi><mi mathvariant="normal">å¼</mi><mi mathvariant="normal">ï¼š</mi><mi mathvariant="normal">é˜¶</mi><mi mathvariant="normal">æ®µ</mi><mi mathvariant="normal">æ“</mi><mi mathvariant="normal">ä½œ</mi><mi mathvariant="normal">ç¬¦</mi><mi mathvariant="normal">å¯</mi><mi mathvariant="normal">ä»¥</mi><mi mathvariant="normal">çœ‹</mi><mi mathvariant="normal">ä½œ</mi><mi mathvariant="normal">æ˜¯</mi><mi mathvariant="normal">&quot;</mi><mi mathvariant="normal">é”®</mi><mi mathvariant="normal">&quot;</mi><mi mathvariant="normal">ï¼Œ</mi><mi mathvariant="normal">æ‰€</mi><mi mathvariant="normal">å¯¹</mi><mi mathvariant="normal">åº”</mi><mi mathvariant="normal">çš„</mi><mi mathvariant="normal">&quot;</mi><mi mathvariant="normal">å€¼</mi><mi mathvariant="normal">&quot;</mi><mi mathvariant="normal">ç§°</mi><mi mathvariant="normal">ä¸º</mi><mi mathvariant="normal">ç®¡</mi><mi mathvariant="normal">é“</mi><mi mathvariant="normal">è¡¨</mi><mi mathvariant="normal">è¾¾</mi><mi mathvariant="normal">å¼</mi><mi mathvariant="normal">ï¼Œ</mi><mi mathvariant="normal">ç®¡</mi><mi mathvariant="normal">é“</mi><mi mathvariant="normal">è¡¨</mi><mi mathvariant="normal">è¾¾</mi><mi mathvariant="normal">å¼</mi><mi mathvariant="normal">å¯</mi><mi mathvariant="normal">ä»¥</mi><mi mathvariant="normal">çœ‹</mi><mi mathvariant="normal">ä½œ</mi><mi mathvariant="normal">æ˜¯</mi><mi mathvariant="normal">ç®¡</mi><mi mathvariant="normal">é“</mi><mi mathvariant="normal">æ“</mi><mi mathvariant="normal">ä½œ</mi><mi mathvariant="normal">ç¬¦</mi><mi mathvariant="normal">çš„</mi><mi mathvariant="normal">æ“</mi><mi mathvariant="normal">ä½œ</mi><mi mathvariant="normal">æ•°</mi><mi mathvariant="normal">ï¼Œ</mi><mi mathvariant="normal">ç®¡</mi><mi mathvariant="normal">é“</mi><mi mathvariant="normal">è¡¨</mi><mi mathvariant="normal">è¾¾</mi><mi mathvariant="normal">å¼</mi><mi mathvariant="normal">æ˜¯</mi><mi mathvariant="normal">ä¸€</mi><mi mathvariant="normal">ä¸ª</mi><mi mathvariant="normal">æ–‡</mi><mi mathvariant="normal">æ¡£</mi><mi mathvariant="normal">ç»“</mi><mi mathvariant="normal">æ„</mi><mi mathvariant="normal">ï¼Œ</mi><mi mathvariant="normal">ç”±</mi><mi mathvariant="normal">å­—</mi><mi mathvariant="normal">æ®µ</mi><mi mathvariant="normal">å</mi><mi mathvariant="normal">ã€</mi><mi mathvariant="normal">å­—</mi><mi mathvariant="normal">æ®µ</mi><mi mathvariant="normal">å€¼</mi><mi mathvariant="normal">å’Œ</mi><mi mathvariant="normal">è¡¨</mi><mi mathvariant="normal">è¾¾</mi><mi mathvariant="normal">å¼</mi><mi mathvariant="normal">æ“</mi><mi mathvariant="normal">ä½œ</mi><mi mathvariant="normal">ç¬¦</mi><mi mathvariant="normal">ç»„</mi><mi mathvariant="normal">æˆ</mi><mi mathvariant="normal">ã€‚</mi><mi mathvariant="normal">èš</mi><mi mathvariant="normal">åˆ</mi><mi mathvariant="normal">ç®¡</mi><mi mathvariant="normal">é“</mi><mi mathvariant="normal">ä½¿</mi><mi mathvariant="normal">ç”¨</mi><mi mathvariant="normal">ä¼˜</mi><mi mathvariant="normal">åŒ–</mi><mi mathvariant="normal">ï¼š</mi><mn>1</mn><mi mathvariant="normal">å°†</mi></mrow><annotation encoding="application/x-tex">out:å°†èšåˆç»“æœå­˜å‚¨åˆ°é›†åˆä¸­ï¼Œå‚æ•°ä¸ºé›†åˆåç§°
    ã€‚ã€‚ã€‚
    èšåˆç®¡é“è¡¨è¾¾å¼ï¼šé˜¶æ®µæ“ä½œç¬¦å¯ä»¥çœ‹ä½œæ˜¯&quot;é”®&quot;ï¼Œæ‰€å¯¹åº”çš„&quot;å€¼&quot;ç§°ä¸ºç®¡é“è¡¨è¾¾å¼ï¼Œç®¡é“è¡¨è¾¾å¼å¯ä»¥çœ‹ä½œæ˜¯ç®¡é“æ“ä½œç¬¦çš„æ“ä½œæ•°ï¼Œç®¡é“è¡¨è¾¾å¼æ˜¯ä¸€ä¸ªæ–‡æ¡£ç»“æ„ï¼Œç”±å­—æ®µåã€å­—æ®µå€¼å’Œè¡¨è¾¾å¼æ“ä½œç¬¦ç»„æˆã€‚
    èšåˆç®¡é“ä½¿ç”¨ä¼˜åŒ–ï¼š
    1å°†</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord cjk_fallback">å°†</span><span class="mord cjk_fallback">èš</span><span class="mord cjk_fallback">åˆ</span><span class="mord cjk_fallback">ç»“</span><span class="mord cjk_fallback">æœ</span><span class="mord cjk_fallback">å­˜</span><span class="mord cjk_fallback">å‚¨</span><span class="mord cjk_fallback">åˆ°</span><span class="mord cjk_fallback">é›†</span><span class="mord cjk_fallback">åˆ</span><span class="mord cjk_fallback">ä¸­</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">å‚</span><span class="mord cjk_fallback">æ•°</span><span class="mord cjk_fallback">ä¸º</span><span class="mord cjk_fallback">é›†</span><span class="mord cjk_fallback">åˆ</span><span class="mord cjk_fallback">å</span><span class="mord cjk_fallback">ç§°</span><span class="mord cjk_fallback">ã€‚</span><span class="mord cjk_fallback">ã€‚</span><span class="mord cjk_fallback">ã€‚</span><span class="mord cjk_fallback">èš</span><span class="mord cjk_fallback">åˆ</span><span class="mord cjk_fallback">ç®¡</span><span class="mord cjk_fallback">é“</span><span class="mord cjk_fallback">è¡¨</span><span class="mord cjk_fallback">è¾¾</span><span class="mord cjk_fallback">å¼</span><span class="mord cjk_fallback">ï¼š</span><span class="mord cjk_fallback">é˜¶</span><span class="mord cjk_fallback">æ®µ</span><span class="mord cjk_fallback">æ“</span><span class="mord cjk_fallback">ä½œ</span><span class="mord cjk_fallback">ç¬¦</span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">ä»¥</span><span class="mord cjk_fallback">çœ‹</span><span class="mord cjk_fallback">ä½œ</span><span class="mord cjk_fallback">æ˜¯</span><span class="mord">&quot;</span><span class="mord cjk_fallback">é”®</span><span class="mord">&quot;</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">æ‰€</span><span class="mord cjk_fallback">å¯¹</span><span class="mord cjk_fallback">åº”</span><span class="mord cjk_fallback">çš„</span><span class="mord">&quot;</span><span class="mord cjk_fallback">å€¼</span><span class="mord">&quot;</span><span class="mord cjk_fallback">ç§°</span><span class="mord cjk_fallback">ä¸º</span><span class="mord cjk_fallback">ç®¡</span><span class="mord cjk_fallback">é“</span><span class="mord cjk_fallback">è¡¨</span><span class="mord cjk_fallback">è¾¾</span><span class="mord cjk_fallback">å¼</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">ç®¡</span><span class="mord cjk_fallback">é“</span><span class="mord cjk_fallback">è¡¨</span><span class="mord cjk_fallback">è¾¾</span><span class="mord cjk_fallback">å¼</span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">ä»¥</span><span class="mord cjk_fallback">çœ‹</span><span class="mord cjk_fallback">ä½œ</span><span class="mord cjk_fallback">æ˜¯</span><span class="mord cjk_fallback">ç®¡</span><span class="mord cjk_fallback">é“</span><span class="mord cjk_fallback">æ“</span><span class="mord cjk_fallback">ä½œ</span><span class="mord cjk_fallback">ç¬¦</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">æ“</span><span class="mord cjk_fallback">ä½œ</span><span class="mord cjk_fallback">æ•°</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">ç®¡</span><span class="mord cjk_fallback">é“</span><span class="mord cjk_fallback">è¡¨</span><span class="mord cjk_fallback">è¾¾</span><span class="mord cjk_fallback">å¼</span><span class="mord cjk_fallback">æ˜¯</span><span class="mord cjk_fallback">ä¸€</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord cjk_fallback">æ–‡</span><span class="mord cjk_fallback">æ¡£</span><span class="mord cjk_fallback">ç»“</span><span class="mord cjk_fallback">æ„</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">ç”±</span><span class="mord cjk_fallback">å­—</span><span class="mord cjk_fallback">æ®µ</span><span class="mord cjk_fallback">å</span><span class="mord cjk_fallback">ã€</span><span class="mord cjk_fallback">å­—</span><span class="mord cjk_fallback">æ®µ</span><span class="mord cjk_fallback">å€¼</span><span class="mord cjk_fallback">å’Œ</span><span class="mord cjk_fallback">è¡¨</span><span class="mord cjk_fallback">è¾¾</span><span class="mord cjk_fallback">å¼</span><span class="mord cjk_fallback">æ“</span><span class="mord cjk_fallback">ä½œ</span><span class="mord cjk_fallback">ç¬¦</span><span class="mord cjk_fallback">ç»„</span><span class="mord cjk_fallback">æˆ</span><span class="mord cjk_fallback">ã€‚</span><span class="mord cjk_fallback">èš</span><span class="mord cjk_fallback">åˆ</span><span class="mord cjk_fallback">ç®¡</span><span class="mord cjk_fallback">é“</span><span class="mord cjk_fallback">ä½¿</span><span class="mord cjk_fallback">ç”¨</span><span class="mord cjk_fallback">ä¼˜</span><span class="mord cjk_fallback">åŒ–</span><span class="mord cjk_fallback">ï¼š</span><span class="mord">1</span><span class="mord cjk_fallback">å°†</span></span></span></span>matchã€$sortæ”¾åˆ°ç®¡é“å¼€å§‹é˜¶æ®µï¼Œæœ‰åˆ©äºåˆ©ç”¨ç´¢å¼•æé«˜æ–‡æ¡£å¤„ç†æ•ˆç‡<br>
2æäº¤è¿‡æ»¤å¯å‡å°‘æµç»åç»­é˜¶æ®µçš„æ–‡æ¡£æ•°é‡<br>
èšåˆç®¡é“çš„é™åˆ¶ï¼š<br>
1è¿”å›æ–‡æ¡£ç»“æœä¸èƒ½è¶…è¿‡16Mï¼Œå¯é€šè¿‡è¿”å›ä¸€ä¸ªæ¸¸æ ‡æˆ–å­˜å‚¨åˆ°é›†åˆä¸­è·³è¿‡æ­¤é™åˆ¶<br>
å•ç›®çš„èšåˆæ“ä½œ<br>
count<br>
distinct<br>
group<br>
MapReduceç¼–ç¨‹æ¨¡å‹</p>
<p>mongoimportå¯ä»¥å¯¼å…¥é›†åˆ</p>
<p>MongoDBæ•°æ®æ›´æ–°<br>
æ–‡æ¡£æ’å…¥å’Œåˆ é™¤ï¼šinsertã€updateã€delete<br>
Bulkå‡½æ•°ï¼šBulkå¯å°†å¤šä¸ªæ•°æ®æ›´æ–°æ“ä½œæ”¾åˆ°ä¸€ä¸ªå¾…æ‰§è¡Œçš„åˆ—è¡¨ä¸­æ‰¹é‡æ¥æ‰§è¡Œï¼Œé¡ºåºæ‰§è¡Œçš„Bulkï¼ˆæŒ‰æ·»åŠ é¡ºåºæ‰§è¡Œï¼Œä¸€ä¸ªæœ‰é—®é¢˜åˆ™é€€å‡ºï¼‰å’Œå¹¶æ‰§è¡Œçš„Bulkï¼ˆéšæœºæ–¹å¼å¹¶è¡Œï¼‰<br>
1åˆå§‹åŒ–Bulkï¼š<br>
å¹¶è¡Œï¼šdb.é›†åˆå.initializeUnorderedBulkOp()<br>
é¡ºåºï¼šdb.é›†åˆå.initializeOrderedBulkOp()<br>
2 bulk.inset({â€¦})<br>
3 bulk.execute()</p>
<p>MMAPv1çš„å†…å­˜åˆ†é…ç­–ç•¥ï¼šå¦‚æœä¸€ä¸ªæ›´æ–°æ“ä½œè¶…è¿‡äº†æ–‡æ¡£åœ¨ç£ç›˜ä¸Šé¢„åˆ†é…çš„ç©ºé—´ï¼ŒMongoDBä¼šé‡æ–°åœ¨ç£ç›˜ä¸Šä¸ºå…¶åˆ†é…ä¸€å—æ›´å¤§çš„è¿ç»­ç©ºé—´ã€‚ä½¿ç”¨&quot;2çš„Næ¬¡æ–¹&quot;çš„æ–¹å¼åˆ†é…å†…å­˜ï¼Œå¦‚ï¼š32ï¼Œ64ï¼Œ128ï¼Œ256â€¦2Mï¼Œ4Mâ€¦<br>
ä¼˜ç‚¹ï¼š1æœ‰åˆ©ç”¨å†…å­˜çš„é‡ç”¨ï¼Œé™ä½ç³»ç»Ÿç¢ç‰‡çš„æ•°é‡ï¼›2å‡å°‘æ•°æ®ç§»åŠ¨é¢‘ç‡ï¼Œæé«˜ç³»ç»Ÿæ•°æ®å†™æ•ˆç‡</p>
<p>æ–‡æ¡£ä¿®æ”¹<br>
WriteResult = db.é›†åˆå.update(query,obj,upsert,multi)<br>
query:æŸ¥è¯¢æ¡ä»¶ï¼Œç›¸å½“äºwhere<br>
objï¼šæ›´æ”¹çš„å†…å®¹ï¼Œç›¸å½“äºSQLä¸­çš„setè¯­å¥<br>
upsertï¼šå½“queryçš„æ–‡æ¡£ä¸å­˜åœ¨æ—¶æ˜¯å¦æ’å…¥ä¸€æ¡æ–°æ–‡æ¡£<br>
multiï¼šå½“queryè¿”å›å¤šä¸ªæ–‡æ¡£æ—¶æ˜¯å¦ä¸€æ¬¡æ›´æ–°æ»¡è¶³æ¡ä»¶çš„æ‰€æœ‰æ–‡æ¡£ï¼Œé»˜è®¤åªæ›´æ–°ä¸€æ¡</p>
<p>å†…åµŒæ–‡æ¡£çš„ä¿®æ”¹ï¼š</p>
<ol>
<li>ä¿®æ”¹æ•´ä¸ªå†…åµŒæ–‡æ¡£ï¼š{$set:{field1:æ–°å†…åµŒæ–‡æ¡£}}</li>
<li>ä¿®æ”¹å†…åµŒæ–‡æ¡£çš„æŸä¸ªå­—æ®µï¼š{$æŸä¸ªä¿®æ”¹æ“ä½œç¬¦:{field1.field2:value}}</li>
</ol>
<p>æ•°ç»„å…ƒç´ ï¼šMongoDBæä¾›äº†å¤§é‡çš„ç‰¹å®šæ“ä½œç¬¦ï¼Œä½¿å¾—æ•°ç»„æ—¢å¯ä»¥ä½œä¸ºæ ˆã€é˜Ÿåˆ—ç­‰æœ‰åºå¯¹è±¡ä½¿ç”¨ï¼Œä¹Ÿå¯å½“ä½œé›†åˆç­‰æ— åºå¯¹è±¡æ¥ä½¿ç”¨</p>
<p>MongoDBçš„å†™å®‰å…¨æœºåˆ¶<br>
å†™è¿‡ç¨‹ï¼šä½¿ç”¨updateã€saveç­‰æ“ä½œæ•°æ®é›†åˆä¸­æ•°æ®æ—¶ï¼Œåªæ˜¯ä¿®æ”¹äº†æ•°æ®å†å†…å­˜ä¸­çš„æ˜ åƒï¼Œæ•°æ®æ›´æ–°å¹¶æ²¡æœ‰åŒæ­¥åœ°ä¿å­˜åˆ°ç£ç›˜ä¸Šï¼Œè€Œä¸”æ›´æ–°å†…å­˜ä¸­æ•°æ®ä¹‹å‰ï¼Œæ›´æ–°æ“ä½œä¼šè¢«è®°å½•åˆ°journalæ—¥å¿—æ–‡ä»¶ä¸­ï¼Œ<br>
æ¯éš”100mså°†å†…å­˜journalä¸­çš„æ—¥å¿—å†™åˆ°ç£ç›˜journalæ—¥å¿—æ–‡ä»¶ä¸­ ï¼Œæ¯éš”60så°†å†…å­˜ä¸­ä¿®æ”¹çš„æ•°æ®å†™ä¼šåˆ°ç£ç›˜ä¸Š<br>
å†™å…¥å®‰å…¨çº§åˆ«ï¼šå†™å…¥å®‰å…¨Write Concernæ˜¯ä¸€ç§å®¢æˆ·ç«¯è®¾ç½®çš„ï¼Œç”¨äºæ§åˆ¶å†™å…¥å®‰å…¨çº§åˆ«çš„æœºåˆ¶ï¼Œé€šè¿‡å†™å…¥å®‰å…¨æœºåˆ¶å¯æé«˜æ•°æ®çš„å¯é æ€§ã€‚<br>
åˆ†ä¸ºå››ä¸ªçº§åˆ«ï¼Œåˆ†åˆ«æ˜¯ï¼š<br>
éç¡®è®¤å¼å†™å…¥Unacknowledgedï¼šå†™æ“ä½œä¸ä¼šè¿”å›ç»“æœï¼Œæ‰€ä»¥æ— æ³•çŸ¥é“æ˜¯å¦å†™å…¥æˆåŠŸï¼›ä½†é€Ÿåº¦å¿«ã€æ•ˆç‡é«˜ã€æ— é˜»å¡<br>
ç¡®è®¤å¼å†™å…¥Acknowledgedï¼šå†™æ“ä½œå¿…é¡»å¾—åˆ°MongoDBæœåŠ¡å™¨çš„å†™å…¥ç¡®è®¤ï¼Œå¦‚æœå¤±è´¥ï¼Œä¼šè¿”å›å¼‚å¸¸<br>
æ—¥å¿—å†™å…¥Journaledï¼šå†™æ“ä½œè¦ç­‰åˆ°æ“ä½œè®°å½•å­˜å‚¨åˆ°Journalæ—¥å¿—æ–‡ä»¶åæ‰è¿”å›ç»“æœ<br>
å¤åˆ¶é›†ç¡®è®¤å†™å…¥Replica Acknowledgedï¼šå†™æ“ä½œä¸ä»…è¦å¾—åˆ°ä¸»èŠ‚ç‚¹çš„å†™å…¥ç¡®è®¤ï¼Œè¿˜è¦å¾—åˆ°ä»èŠ‚ç‚¹çš„å†™å…¥ç¡®è®¤ï¼Œå¯ä»¥è®¾ç½®å†™å…¥èŠ‚ç‚¹çš„ä¸ªæ•°ï¼ˆåŒ…å«ä¸»èŠ‚ç‚¹ï¼‰</p>
<p>journalæ—¥å¿—ç›¸å½“äºoracleä¸­çš„redoæ—¥å¿—æ–‡ä»¶ï¼Œç”¨æˆ·æ•…éšœæ¢å¤å’ŒæŒä¹…ã€‚Journalé»˜è®¤100msåˆ·æ–°ä¸€æ¬¡ï¼Œæ‰€ä»¥æœ€å¤šä¸¢å¤±100msæ•°æ®<br>
æ–‡ä»¶ä½äºjournalç›®å½•ä¸­ï¼Œåªèƒ½ä»¥è¿½åŠ æ–¹å¼æ·»åŠ æ•°æ®ï¼Œæ–‡ä»¶åä»¥&quot;j._&quot;å¼€å¤´ï¼Œè¶…è¿‡1Gä¼šè‡ªåŠ¨åˆ›å»ºæ–°çš„ï¼›æ•°æ®åº“æ­£å¸¸å…³é—­æ—¶ï¼Œæ•°æ®åº“æœåŠ¡ä¼šè‡ªåŠ¨æ¸…ç©ºjournalç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶</p>
<p>è®¾ç½®å†™å®‰å…¨æ“ä½œçº§åˆ«ï¼Œå…¶å®å°±æ˜¯åœ¨å†™æ“ä½œçš„æ€§èƒ½å’Œå¯é æ€§é—´å–ä¸€ä¸ªæƒè¡¡ï¼›ä½¿ç”¨çš„å†™æ“ä½œçº§åˆ«è¶Šé«˜ï¼Œæ—¶é—´è¶Šé•¿ï¼Œå¯é æ€§è¶Šé«˜</p>
<p>ä½¿ç”¨writeConcernå‡½æ•°ä½œä¸ºæ›´æ–°å‡½æ•°çš„ä¸€ä¸ªå‚æ•°æ¥è®¾ç½®å†™å®‰å…¨çº§åˆ«,å¦‚ï¼šdb.é›†åˆåç§°.insert({name:â€œjoeâ€},{writeConcern:{j:true}}),writeConcernå‡½æ•°å‚æ•°å¦‚ä¸‹ï¼š<br>
wé€‰é¡¹ï¼Œå¯é€‰æ‹©0ï¼Œ1ï¼Œ2ç­‰æ•´æ•°å€¼åŠ&quot;majority&quot;ï¼Œ0-éç¡®è®¤å¼å†™å…¥ 1-ç¡®è®¤å¼å†™å…¥ï¼ˆæœªå¯ç”¨å¤åˆ¶é›†ï¼‰ï¼ä¸»èŠ‚ç‚¹ç¡®è®¤å¼å†™å…¥ï¼ˆå¯ç”¨äº†å¤åˆ¶é›†ï¼‰ï¼Œ&gt;1åªèƒ½ç”¨äºå¤åˆ¶é›†ï¼Œ2-æ•°æ®è‡³å°‘å†™åˆ°1ä¸ªä»èŠ‚ç‚¹åè¿”å›ï¼Œmajority åªèƒ½ç”¨äºå¤åˆ¶é›†ï¼Œè¡¨ç¤ºæ›´æ–°æ“ä½œç”¨åˆ°å¤§å¤šæ•°ä»èŠ‚ç‚¹<br>
jé€‰é¡¹ï¼Œè®¾ç½®ä¸ºtrueæ¥ä½¿ç”¨journaledæ—¥å¿—å®‰å…¨çº§åˆ«<br>
wtimeouté€‰é¡¹ï¼Œç”¨äºè®¾ç½®è¶…æ—¶å•ä½ä¸ºæ¯«ç§’<br>
ä»¥ä¸Šé€‰é¡¹å¯ç»„åˆä½¿ç”¨</p>
<p>æ•°æ®MongoDBæ•°æ®æŸ¥è¯¢<br>
Cursor = db.é›†åˆåç§°.find(query,fields,limit,skip)<br>
query:æŸ¥è¯¢æ¡ä»¶ï¼Œç›¸å½“äºwhere<br>
fields:ç”¨äºå­—æ®µæ˜ å°„ï¼Œè¯­æ³•æ ¼å¼ï¼š{field:0}ï¼ˆ0è¡¨ç¤ºè¿”å›ç»“æœä¸åŒ…å«æ­¤å­—æ®µï¼‰æˆ–{field:1}ï¼ˆ1è¡¨ç¤ºè¿”å›ç»“æœä¸åŒ…å«æ­¤å­—æ®µï¼‰ï¼Œé»˜è®¤åŒ…å«_idå­—æ®µ,ç›¸å½“äºselectä¸­åé¢éœ€è¦çš„å­—æ®µ<br>
limitï¼šé™åˆ¶æŸ¥è¯¢ç»“æœé›†çš„æ•°é‡ï¼ŒæŒ‡å®šæŸ¥è¯¢è¿”å›ç»“æœçš„æ•°é‡ä¸Šé™ï¼Œä¹Ÿå¯é€šè¿‡limit()å®ç°<br>
skip:è·³è¿‡ä¸€å®šæ•°æ®é‡çš„ç»“æœï¼Œè®¾ç½®ç¬¬ä¸€æ¡è¿”å›æ–‡æ¡£çš„åç§»é‡ï¼Œä¹Ÿå¯é€šè¿‡skip()å®ç°<br>
findæŸ¥è¯¢åªèƒ½æ­£å¯¹ä¸€ä¸ªé›†åˆï¼›è¿”å›çš„é›†åˆé»˜è®¤æ˜¯æ— åºçš„</p>
<p>db.é›†åˆåç§°.findOne()åªè¿”å›ç¬¬ä¸€æ¡æ•°æ®</p>
<p>æŸ¥è¯¢æ“ä½œç¬¦<br>
æ¯”è¾ƒæŸ¥è¯¢æ“ä½œç¬¦<br>
é€»è¾‘æŸ¥è¯¢æ“ä½œç¬¦<br>
å…ƒç´ æŸ¥è¯¢æ“ä½œç¬¦<br>
$whereæŸ¥è¯¢æ“ä½œç¬¦ï¼šå¯ä»¥å°†JavaScriptè¡¨è¾¾å¼çš„å­—ç¬¦ä¸²æˆ–JavaScriptå‡½æ•°ä½œä¸ºæŸ¥è¯¢è¯­å¥çš„ä¸€éƒ¨åˆ†ï¼Œåœ¨jsè¡¨è¾¾å¼å’Œå‡½æ•°ä¸­ï¼Œå¯ä½¿ç”¨thisæˆ–objæ¥å¼•ç”¨å½“å‰æ“ä½œçš„æ–‡æ¡£ï¼Œå½“jsè¡¨è¾¾å¼æˆ–å‡½æ•°è¿”å›trueæ—¶ï¼Œæ‰ä¼šè¿”å›å½“å‰æ–‡æ¡£</p>
<p>å†…åµŒæ–‡æ¡£ä¸æ•°ç»„æŸ¥è¯¢<br>
å†…åµŒæ–‡æ¡£æŸ¥è¯¢<br>
1æŸ¥è¯¢æ•´ä¸ªå†…åµŒæ–‡æ¡£ï¼šå½“å†…åµŒæ–‡æ¡£çš„é”®å€¼å¯¹æ•°é‡å’Œé”®å€¼å¯¹é¡ºåºéƒ½ç›¸åŒæ—¶ï¼Œæ‰ä¼šåŒ¹é…<br>
2æŸ¥è¯¢æ–‡æ¡£çš„æŸä¸ªå­—æ®µï¼šéœ€è¦ä½¿ç”¨.å·æ“ä½œç¬¦ï¼Œå¦‚:db.user.find({â€œaddress.cityâ€:â€œBeiJingâ€})<br>
æ•°ç»„æŸ¥è¯¢<br>
1æŸ¥è¯¢æ•´ä¸ªæ•°ç»„ï¼šå½“æ•°ç»„å…ƒç´ å†…å®¹å’Œæ•°ç»„å…ƒç´ é¡ºåºéƒ½ç›¸åŒæ—¶ï¼Œæ‰ä¼šåŒ¹é…<br>
2æŸ¥è¯¢æ•°ç»„ä¸­çš„å…ƒç´ ï¼ˆæ™®é€šå…ƒç´ ï¼‰ï¼š<br>
Aä¸ä½ç½®æ— å…³ï¼ŒæŸ¥è¯¢æ•°ç»„ä¸­å«æœ‰æŸä¸ªå€¼çš„æ–‡æ¡£ï¼Œå¦‚ï¼šdb.user.find({score:80})<br>
Bä¸ä½ç½®æœ‰å…³ï¼ŒæŒ‰ç…§æŒ‡å®šçš„æ•°ç»„ç´¢å¼•æŸ¥è¯¢æ•°ç»„å…ƒç´ çš„å€¼ï¼Œå¦‚ï¼šdb.user.find({â€˜scores.2â€™:80})<br>
3æŸ¥è¯¢æ•°ç»„ä¸­çš„æ•°ç»„å…ƒç´ æ˜¯æ–‡æ¡£æ—¶ï¼ŒæŸ¥è¯¢æ•°ç»„å…ƒç´ æœ‰ä¸¤ç§æƒ…å†µ<br>
Aä¸ä½ç½®æ— å…³ï¼ŒæŸ¥è¯¢æ•°ç»„ä¸­æ»¡è¶³æ¡ä»¶çš„å­æ–‡æ¡£å…ƒç´ ï¼Œå¦‚ï¼šdb.user.find(â€˜scores.æˆç»©â€™ï¼š95)<br>
Bä¸ä½ç½®æœ‰å…³ï¼ŒæŒ‰ç…§æŒ‡å®šçš„æ•°ç»„ç´¢å¼•æŸ¥è¯¢æ•°ç»„å­æ–‡æ¡£ï¼Œå¦‚ï¼š db.user.find(â€˜scores.2.æˆç»©â€™ï¼š95)</p>
<p>MongoDBæŸ¥è¯¢ç»“æœè¿”å›è¿‡ç¨‹ï¼šfindå‡½æ•°æŸ¥è¯¢ç»“æœæ˜¯ä»¥å¤šæ¡æ–‡æ¡£çš„å½¢å¼åˆ†æ‰¹æ¥è¿”å›æŸ¥è¯¢ç»“æœçš„ï¼Œè¿”å›çš„æ–‡æ¡£ä¼šç¼“å­˜åˆ°å†…å­˜ä¸­ï¼ŒCursoråœ¨ä¸€æ‰¹æ•°æ®å›æ¥ä¹‹åéå†ï¼Œä¸‹ä¸€æ‰¹æ²¡æ¥æ—¶ä¼šè‡ªåŠ¨å‘èµ·ä¸‹ä¸€æ‰¹è¯·æ±‚ï¼Œç„¶åç»§ç»­éå†</p>
<p>MongoDBæ¸¸æ ‡ï¼šç”¨æ¥éå†ç»“æœé›†ä¸­çš„æ•°æ®ã€‚<br>
æ¸¸æ ‡çš„ç”Ÿå‘½å‘¨æœŸï¼šåˆ›å»ºã€ä½¿ç”¨ã€é”€æ¯<br>
æ¸¸æ ‡å¯èƒ½ä¼šè¿”å›é‚£äº›ç”±äºä½“ç§¯å˜å¤§è€Œè¢«ç§»åŠ¨åˆ°é›†åˆæœ«å°¾çš„æ–‡æ¡£è€Œé‡å¤è¿”å›ï¼Œå¯é€šè¿‡å¯¹æŸ¥è¯¢å¿«ç…§çš„æ–¹å¼è§£å†³æ­¤é—®é¢˜ï¼Œè¯­æ³•ä¸ºï¼šdb.collection.find().snapshot().<br>
ä½¿ç”¨å¿«ç…§ä¹‹åï¼ŒæŸ¥è¯¢å°±ä¼šåœ¨_idç´¢å¼•ä¸Šæ¥éå†æ‰§è¡Œï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯æ¯ä¸ªæ–‡æ¡£åªè¢«è¿”å›ä¸€æ¬¡ï¼Œä»è€Œä¿è¯è·å–ç»“æœçš„ä¸€è‡´æ€§ã€‚</p>
<p>æ¨¡ç³ŠæŸ¥è¯¢ï¼šæŸ¥è¯¢æ¡ä»¶å¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å®ç°æ¨¡ç³ŠæŸ¥è¯¢ï¼Œæ”¯æŒæ­£åˆ™è¡¨è¾¾å¼æ“ä½œç¬¦å’Œæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ä¸¤ç§ã€‚<br>
æ­£åˆ™è¡¨è¾¾å¼æ“ä½œç¬¦ï¼š$regex</p>
<p>findAndModifyå‡½æ•°ä½¿ç”¨æ‰§è¡Œåˆ†ä¸ºfindå’Œupdateä¸¤æ­¥ï¼Œä½†å¯ä»¥ä¿è¯æ“ä½œçš„åŸå­æ€§</p>
<p>MongoDBæ˜¯ä¸ºåˆ†å¸ƒå¼å­˜å‚¨è€Œè®¾è®¡ï¼Œ_idä¸»é”®é»˜è®¤ä½¿ç”¨ObjectIdç±»å‹çš„å€¼ï¼Œæ¯”è‡ªå¢æ–¹å¼æ›´é€‚åˆåˆ†å¸ƒå¼ç¯å¢ƒï¼Œæ‰€ä»¥MongoDBé»˜è®¤ä¸æ”¯æŒå­—æ®µè‡ªå¢é•¿åŠŸèƒ½</p>
<p>MongoDBç´¢å¼•ï¼šæ•°æ®åº“ç´¢å¼•æ˜¯å¯¹æ•°æ®è¡¨ä¸­ä¸€åˆ—æˆ–å¤šåˆ—çš„å€¼è¿›è¡Œæ’åºçš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œä½¿ç”¨ç´¢å¼•å¯å¿«é€Ÿè®¿é—®æ•°æ®è¡¨ä¸­çš„ç‰¹å®šä¿¡æ¯ã€‚MogonDBç´¢å¼•ä¸ä»…æé«˜æ–‡æ¡£æŸ¥è¯¢é€Ÿåº¦ï¼Œè¿˜æœ‰åˆ©äºæ’åºæ—¶èŠ‚çœå†…å­˜èµ„æºã€‚<br>
MongoDBæ‰€æœ‰çš„ç´¢å¼•ä¿¡æ¯è¢«ä¿å­˜åœ¨system.indexesé›†åˆä¸­ï¼Œä¸”é»˜è®¤æ€»ä¸º_idåˆ›å»ºå•å­—æ®µå‡åºå…·æœ‰å”¯ä¸€å±æ€§çš„ç´¢å¼•ï¼Œå¯é€šè¿‡db.system.indexes.find()æŸ¥çœ‹æ‰€æœ‰ç´¢å¼•<br>
MongoDBå¯åœ¨å•ä¸ªå­—æ®µä¸Šå»ºç«‹ç´¢å¼•ï¼Œå­—æ®µå¯ä»¥æ˜¯æ™®é€šå­—æ®µã€æ•´ä¸ªæ–‡æ¡£ä»¥åŠå­æ–‡æ¡£çš„æŸä¸ªå­—æ®µ<br>
å¯¹äºå¤åˆç´¢å¼•ï¼ŒMongoDBæ”¯æŒå‰ç¼€åŒ¹é…<br>
ä¸ºç¡®ä¿æŸ¥è¯¢åªä½¿ç”¨å¤åˆç´¢å¼•ï¼Œå¯ä»¥ä½¿ç”¨æ˜ å°„æ¥æŒ‡å®šä¸è¦è¿”å›_idå­—æ®µï¼ˆé™¤éå®ƒæ˜¯å¤åˆç´¢å¼•çš„ä¸€éƒ¨åˆ†ï¼‰<br>
å¤šé”®ç´¢å¼•ï¼šæ˜¯å¯¹æ•°ç»„ç±»å‹å»ºç«‹çš„ç´¢å¼•ï¼Œå®é™…ä¸Šæ˜¯å¯¹æ•°ç»„çš„æ¯ä¸ªå…ƒç´ å»ºç«‹ç´¢å¼•ï¼Œè€Œä¸æ˜¯æ•°ç»„æœ¬èº«å»ºç«‹ç´¢å¼•ï¼›å½“æ•°ç»„å…ƒç´ æ˜¯æ–‡æ¡£æ—¶ï¼Œå¯ä¸ºæ–‡æ¡£çš„æŸä¸ªå­—æ®µå»ºç«‹å¤šé”®ç´¢å¼•<br>
å“ˆå¸Œç´¢å¼•ï¼šåªæ”¯æŒç­‰å€¼æŸ¥è¯¢ï¼Œä¸æ”¯æŒèŒƒå›´æŸ¥è¯¢ï¼Œä¸»è¦ç”¨äºåˆ†ç‰‡çš„é›†åˆä¸Šï¼Œå¯ä»¥ä½œä¸ºç‰‡é”®æ¥ä½¿ç”¨ï¼Œèƒ½å°†æ•°æ®æ¯”è¾ƒå‡åŒ€çš„åˆ†æ•£å­˜å‚¨åœ¨å„ä¸ªåˆ†ç‰‡ä¸Šï¼Œå¦‚ï¼šdb.é›†åˆå.createIndex({name:â€œhashedâ€})</p>
<p>MongoDBç´¢å¼•çš„å±æ€§<br>
å”¯ä¸€ç´¢å¼•:å¯ä»¥ç¡®ä¿é›†åˆçš„æ¯ä¸€ä¸ªæ–‡æ¡£çš„ç´¢å¼•å­—æ®µéƒ½æœ‰å”¯ä¸€çš„å€¼ï¼Œä¸ä¼šå‡ºç°é‡å¤å€¼ï¼Œå¦‚ï¼šdb.é›†åˆå.createIndex({name:1},{unique:true})ï¼Œåœ¨éç©ºé›†åˆåˆ›å»ºå”¯ä¸€ç´¢å¼•å¯èƒ½ä¼šå› ä¸ºå·²æœ‰é‡å¤å€¼è€Œå¤±è´¥ï¼Œå¯æ·»åŠ dropBups:trueåˆ é™¤é‡å¤æ–‡æ¡£<br>
ç¨€ç–ç´¢å¼•ï¼šåªä¼šä¸ºç´¢å¼•å­—æ®µå­˜åœ¨çš„æ–‡æ¡£å»ºç«‹ç´¢å¼•ï¼Œå³ä½¿ç´¢å¼•å­—æ®µçš„å€¼ä¸ºnullï¼Œä½†ä¸ä¼šä¸ºç´¢å¼•å­—æ®µä¸å­˜åœ¨çš„æ–‡æ¡£å»ºç«‹ç´¢å¼•<br>
TTL(Time To Live)ç´¢å¼•ï¼šä¸ºæ–‡æ¡£è®¾ç½®ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œå½“è¾¾åˆ°é¢„è®¾ç½®çš„æ—¶é—´åï¼Œè¯¥æ–‡æ¡£ä¼šè¢«æ•°æ®åº“è‡ªåŠ¨åˆ é™¤ï¼Œä½†åˆ é™¤å¯èƒ½æœ‰å»¶è¿Ÿã€‚è¿™ç§ç±»å‹çš„ç´¢å¼•å¯¹ç¼“å­˜é—®é¢˜éå¸¸æœ‰ç”¨ã€‚åªèƒ½å»ºç«‹åœ¨å•ç‹¬é_idå­—æ®µ<br>
åˆ›å»ºäº†TTLç´¢å¼•åï¼ŒMongoDBä¼šæœ‰ä¸€ä¸ªåå°çº¿ç¨‹æ¥ç®¡ç†æ–‡æ¡£ï¼›åœ¨å¤åˆ¶é›†ä¸Šå»ºç«‹çš„TTLç´¢å¼•ï¼ŒTTLåå°çº¿ç¨‹åªä¼šè¿è¡Œåœ¨ä¸»èŠ‚ç‚¹ä¸Š</p>
<p>MongoDBç´¢å¼•çš„ç®¡ç†<br>
ç´¢å¼•çš„é»˜è®¤å‘½åè§„åˆ™ï¼škeyname1_dir1_keyname2_dir2â€¦ï¼Œå…¶ä¸­keynameXæ˜¯ç´¢å¼•å­—æ®µçš„åç§°ï¼ŒdirXæ˜¯ç´¢å¼•æ–¹å‘ï¼Œ1å‡åº-1é™åºï¼Œä¹Ÿå¯è‡ªå®šä¹‰å‘½å<br>
åˆ›å»ºç´¢å¼•ï¼šdb.é›†åˆå.createIndex(keys,options),è¿”å›å€¼ä¸ºä¸€ä¸ªæ–‡æ¡£ç±»å‹ã€‚ç´¢å¼•ä¸€æ—¦åˆ›å»ºå°±ä¸èƒ½ä¿®æ”¹ï¼Œåˆ›å»ºåå¯é€šè¿‡db.é›†åˆå.getIndexes()æŸ¥çœ‹é›†åˆæ‰€æ‹¥æœ‰çš„ç´¢å¼•ï¼Œåˆ›å»ºç´¢å¼•æœ‰ä¸¤ç§æ–¹å¼ï¼š<br>
1foreground:é˜»å¡æ‰€æœ‰å¯¹æ•°æ®åº“çš„è¯»å†™è¯·æ±‚ï¼Œç›´åˆ°ç´¢å¼•åˆ›å»ºå®Œæˆï¼Œä¸ºé»˜è®¤æ–¹å¼<br>
2backgroundï¼šåˆ›å»ºç´¢å¼•æ—¶ï¼Œå¦‚æœæœ‰æ–°çš„æ•°æ®åº“è¯·æ±‚ï¼Œåˆ›å»ºè¿‡ç¨‹ä¼šæš‚åœ<br>
åˆ é™¤ç´¢å¼•ï¼šdb.é›†åˆ.dropIndex(index)<br>
æŸ¥è¯¢ä¼˜åŒ–å™¨ï¼šç”¨æ¥ä¼˜åŒ–æŸ¥è¯¢è¿‡ç¨‹ï¼Œé€šè¿‡æ¯”è¾ƒè¿”å›100æ¡æ–‡æ¡£é€Ÿåº¦å¾—åˆ°æœ€ä½³æŸ¥è¯¢è®¡åˆ’<br>
explainå‡½æ•°ï¼šèƒ½å¤Ÿæä¾›å¤§é‡ä¸æŸ¥è¯¢æœ‰å…³çš„ä¿¡æ¯ï¼Œå¯ä»¥å¾ˆå¥½çš„è¯„ä¼°ç´¢å¼•æ€§èƒ½ï¼Œå¸®åŠ©ä¼˜åŒ–ç´¢å¼•çš„ä½¿ç”¨ç­–ç•¥ã€‚db.é›†åˆ.find().explain(mode),æ”¯æŒ3ç§æ¨¡å¼ï¼š<br>
1queryPlannerï¼šæŸ¥è¯¢è®¡åˆ’ï¼Œé»˜è®¤<br>
2executionStatusï¼šæŸ¥è¯¢æ€§èƒ½ç»Ÿè®¡<br>
3allPlansExecutionï¼šæ‰€æœ‰è®¡åˆ’ç»Ÿè®¡ä¿¡æ¯ï¼ˆæœ€ä¼˜ä¸è¢«æ‹’ç»çš„è®¡åˆ’ï¼‰<br>
explainè¿”å›ç»“æœä½¿ç”¨ç”±å¤šä¸ªé˜¶æ®µï¼ˆStageï¼‰ç»„æˆçš„æ ‘å½¢ç»“æ„æ¥è¡¨ç¤ºæŸ¥è¯¢è®¡åˆ’ï¼ŒæŸ¥è¯¢è®¡åˆ’è‡ªä¸‹è€Œä¸Šæ‰§è¡Œï¼Œæ ‘çš„å¶èŠ‚ç‚¹ç”¨æ¥è®¿é—®æ–‡æ¡£æˆ–ç´¢å¼•ï¼Œå†…éƒ¨èŠ‚ç‚¹å¤„ç†ä¸‹å±‚èŠ‚ç‚¹è¿”å›æ–‡æ¡£æˆ–ç´¢å¼•ï¼Œæ ¹èŠ‚ç‚¹è¾“å‡ºæŸ¥è¯¢ç»“æœ<br>
hintå‡½æ•°ï¼šå¼ºåˆ¶MongoDBä½¿ç”¨ç‰¹å®šç´¢å¼•</p>
<p>MongoDBç‰¹æ®Šç´¢å¼•<br>
åœ°ç†ç©ºé—´ç´¢å¼•ï¼šå¯¹åœ°ç†ä½ç½®æ•°æ®å»ºç«‹ç´¢å¼•ï¼ŒMongoDBæ”¯æŒä¸¤ç§2dsphereçƒé¢ç´¢å¼•å’Œå¹³é¢2dç´¢å¼•<br>
2dSphereçƒé¢ç´¢å¼•<br>
2då¹³é¢ç´¢å¼•</p>
<p>å…¨æ–‡ç´¢å¼•ï¼šåˆç§°ä¸ºå€’æ’ç´¢å¼•ï¼Œç”¨äºåœ¨å¤§é‡æ–‡æœ¬ä¸­å¯¹æ¯ä¸€ä¸ªè¯ç»„å»ºç«‹ç´¢å¼•ï¼ŒæŒ‡å‡ºè¯¥è¯åœ¨æ•´æ®µæ–‡æœ¬ä¸­å‡ºç°çš„ä½ç½®å’Œæ¬¡æ•°ï¼Œæ­¤æŠ€æœ¯ä¸»è¦ç”¨äºæœç´¢å¼•æ“å’Œç«™å†…æœç´¢ç­‰ã€‚<br>
ä¸€ä¸ªé›†åˆåªèƒ½æœ‰ä¸€ä¸ªå…¨æ–‡ç´¢å¼•</p>
<p>javaå¯¹mongodbçš„ä½¿ç”¨<br>
é›†ç¾¤æ­å»ºï¼šmongodbåˆ†å¸ƒå¼é›†ç¾¤æ­å»ºæ‰‹è®°</p>
<p>å­¦ä¹ ï¼š<a href="http://www.cnblogs.com/huangxincheng/archive/2012/02/18/2356595.html" target="_blank" rel="noopener">http://www.cnblogs.com/huangxincheng/archive/2012/02/18/2356595.html</a></p>
<p>åˆ†ææ²¡æœ‰é»˜è®¤çš„ï¼Œå› ä¸ºä½ è¿˜æ²¡ç»™rootè®¾ç½®å¯†ç ï¼Œç¬¬ä¸€ä¸ª user æ˜¯åœ¨ admin ç»„ ï¼Œæ‰€ä»¥ä»–å¯ä»¥ç»™ root è®¾ç½®å¯†ç  , so<br>
sudo passwd root</p>
<p>Language Support</p>
<p><a href="http://blog.csdn.net/sinat_35418761/article/details/53241481" target="_blank" rel="noopener">http://blog.csdn.net/sinat_35418761/article/details/53241481</a></p>
<p><a href="http://www.2cto.com/database/201504/395442.html" target="_blank" rel="noopener">http://www.2cto.com/database/201504/395442.html</a><br>
<a href="http://www.myexception.cn/operating-system/1685604.html" target="_blank" rel="noopener">http://www.myexception.cn/operating-system/1685604.html</a></p>
<p><a href="https://my.oschina.net/chinacaptain/blog/465723" target="_blank" rel="noopener">https://my.oschina.net/chinacaptain/blog/465723</a></p>
<p><a href="http://api.mongodb.com/java/current/" target="_blank" rel="noopener">http://api.mongodb.com/java/current/</a></p>
<p>MongoDBæ˜¯ä»€ä¹ˆ<br>
MongoDBæ˜¯ä¸€ä¸ªåŸºäºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„æ•°æ®åº“ã€‚ç”±C++è¯­è¨€ç¼–å†™ã€‚æ—¨åœ¨ä¸ºWEBåº”ç”¨æä¾›å¯æ‰©å±•çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚<br>
ä»–çš„ç‰¹ç‚¹:é«˜æ€§èƒ½ã€æ˜“éƒ¨ç½²ã€æ˜“ä½¿ç”¨ï¼Œå­˜å‚¨æ•°æ®éå¸¸æ–¹ä¾¿ã€‚</p>
<p>Bsonï¼šBinary Serialized Document Formatï¼Œæ˜¯ä¸€ç§ç±»jsonçš„ä¸€ç§äºŒè¿›åˆ¶å½¢å¼çš„å­˜å‚¨æ ¼å¼ï¼Œç®€ç§°Binary JSONï¼Œå®ƒå’ŒJSONä¸€æ ·ï¼Œæ”¯æŒå†…åµŒçš„æ–‡æ¡£å¯¹è±¡å’Œæ•°ç»„å¯¹è±¡ï¼Œä½†æ˜¯BSONæœ‰JSONæ²¡æœ‰çš„ä¸€äº›æ•°æ®ç±»å‹ï¼Œå¦‚Dateå’ŒBinDataç±»å‹</p>

          
        
      
    </div>
    
    
    

    <div>
          
    </div>

    

    <div>
      
    </div>


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://chetaofeng.github.io/2019/02/14/Linux-ç¦ç”¨SELinuxæ—¶é…ç½®é”™è¯¯å¯¼è‡´ç³»ç»Ÿä¸èƒ½å¤Ÿå¯åŠ¨çš„è§£å†³æ–¹æ³•/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è¡Œé”‹">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/pub-images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è¡Œé”‹">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/14/Linux-ç¦ç”¨SELinuxæ—¶é…ç½®é”™è¯¯å¯¼è‡´ç³»ç»Ÿä¸èƒ½å¤Ÿå¯åŠ¨çš„è§£å†³æ–¹æ³•/" itemprop="url">ç¦ç”¨SELinuxæ—¶é…ç½®é”™è¯¯å¯¼è‡´ç³»ç»Ÿä¸èƒ½å¤Ÿå¯åŠ¨çš„è§£å†³æ–¹æ³•</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-02-14T16:21:27+08:00">
                2019-02-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>CentOSåœ¨å®‰è£…æŸäº›è½¯ä»¶çš„æ—¶å€™ï¼Œéœ€è¦å…³é—­SELinuxï¼Œåœ¨ä¿®æ”¹é…ç½®æ–‡ä»¶/etc/selinux/configè¿‡ç¨‹ä¸­ï¼Œè®¾ç½®æ–¹æ³•ä¸ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># SELINUX=enforcing</span><br><span class="line">SELINUX=disabled</span><br></pre></td></tr></table></figure>
<p>å¦‚æœè®¾ç½®ä¹‹åï¼Œæ²¡æœ‰è®¾ç½®å›æ¥ï¼Œåˆ™å¯åŠ¨çš„æ—¶å€™å°±ä¼šæ— æ³•å¯åŠ¨ï¼Œè§£å†³åŠæ³•ä¸ºï¼š</p>
<ul>
<li>ç³»ç»Ÿå¯åŠ¨çš„æ—¶å€™ï¼ŒæŒ‰ä¸‹â€˜eâ€™é”®è¿›å…¥grubç¼–è¾‘ç•Œé¢ï¼Œ</li>
<li>ç¼–è¾‘grubèœå•ï¼Œé€‰æ‹©â€œkernel /vmlinuz-2.6.23.1-42.fc8 ro root=/dev/vogroup00/logvol00 rhgb quietâ€ ä¸€æ </li>
<li>æŒ‰â€˜eâ€™é”®è¿›å…¥ç¼–è¾‘</li>
<li>åœ¨æœ«å°¾å¢åŠ enforcing=0ï¼Œå³ï¼š<br>
kernel /vmlinuz-2.6.23.1-42.fc8 ro root=/dev/vogroup00/logvol00 rhgb quiet enforcing=0</li>
<li>æŒ‰â€˜bâ€™é”®ç»§ç»­å¼•å¯¼ï¼ŒOKé¡ºåˆ©å‰è¿›ã€‚</li>
</ul>

          
        
      
    </div>
    
    
    

    <div>
          
    </div>

    

    <div>
      
    </div>


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://chetaofeng.github.io/2019/02/14/Linux-RHEL-7-ä¸­-systemctl-çš„ç”¨æ³•ï¼ˆæ›¿ä»£service-å’Œ-chkconfigï¼‰/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è¡Œé”‹">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/pub-images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è¡Œé”‹">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/14/Linux-RHEL-7-ä¸­-systemctl-çš„ç”¨æ³•ï¼ˆæ›¿ä»£service-å’Œ-chkconfigï¼‰/" itemprop="url">RHEL 7 ä¸­ systemctl çš„ç”¨æ³•ï¼ˆæ›¿ä»£service å’Œ chkconfigï¼‰</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-02-14T16:20:58+08:00">
                2019-02-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>systemctlæ˜¯RHEL 7 çš„æœåŠ¡ç®¡ç†å·¥å…·ä¸­ä¸»è¦çš„å·¥å…·ï¼Œå®ƒèåˆä¹‹å‰serviceå’Œchkconfigçš„åŠŸèƒ½äºä¸€ä½“ã€‚å¯ä»¥ä½¿ç”¨å®ƒæ°¸ä¹…æ€§æˆ–åªåœ¨å½“å‰ä¼šè¯ä¸­å¯ç”¨/ç¦ç”¨æœåŠ¡ã€‚</p>
</blockquote>
<blockquote>
<p>Systemctlæ˜¯ä¸€ä¸ªsystemdå·¥å…·ï¼Œä¸»è¦è´Ÿè´£æ§åˆ¶systemdç³»ç»Ÿå’ŒæœåŠ¡ç®¡ç†å™¨ã€‚</p>
</blockquote>
<blockquote>
<p>Systemdæ˜¯ä¸€ä¸ªç³»ç»Ÿç®¡ç†å®ˆæŠ¤è¿›ç¨‹ã€å·¥å…·å’Œåº“çš„é›†åˆï¼Œç”¨äºå–ä»£System Våˆå§‹è¿›ç¨‹ã€‚Systemdçš„åŠŸèƒ½æ˜¯ç”¨äºé›†ä¸­ç®¡ç†å’Œé…ç½®ç±»UNIXç³»ç»Ÿ</p>
</blockquote>
<blockquote>
<p>å¯ç”¨æœåŠ¡å°±æ˜¯åœ¨å½“å‰â€œrunlevelâ€çš„é…ç½®æ–‡ä»¶ç›®å½•/etc/systemd/system/multi-user.target.wants/é‡Œï¼Œå»ºç«‹/usr/lib/systemd/systemé‡Œé¢å¯¹åº”æœåŠ¡é…ç½®æ–‡ä»¶çš„è½¯é“¾æ¥ï¼›ç¦ç”¨æœåŠ¡å°±æ˜¯åˆ é™¤æ­¤è½¯é“¾æ¥ï¼Œæ·»åŠ æœåŠ¡å°±æ˜¯æ·»åŠ è½¯è¿æ¥</p>
</blockquote>
<blockquote>
<p>Systemctlæ¥å—æœåŠ¡ï¼ˆ.serviceï¼‰ï¼ŒæŒ‚è½½ç‚¹ï¼ˆ.mountï¼‰ï¼Œå¥—æ¥å£ï¼ˆ.socketï¼‰å’Œè®¾å¤‡ï¼ˆ.deviceï¼‰ä½œä¸ºå•å…ƒã€‚</p>
</blockquote>
<ul>
<li>å¯åŠ¨ä¸€ä¸ªæœåŠ¡ï¼šsystemctl start postfix.service</li>
<li>å…³é—­ä¸€ä¸ªæœåŠ¡ï¼šsystemctl stop postfix.service</li>
<li>é‡å¯ä¸€ä¸ªæœåŠ¡ï¼šsystemctl restart postfix.service</li>
<li>æ˜¾ç¤ºä¸€ä¸ªæœåŠ¡çš„çŠ¶æ€ï¼šsystemctl status postfix.service</li>
<li>åœ¨å¼€æœºæ—¶å¯ç”¨ä¸€ä¸ªæœåŠ¡ï¼šsystemctl enable postfix.service</li>
<li>åœ¨å¼€æœºæ—¶ç¦ç”¨ä¸€ä¸ªæœåŠ¡ï¼šsystemctl disable postfix.service</li>
<li>æŸ¥çœ‹æœåŠ¡æ˜¯å¦å¼€æœºå¯åŠ¨ï¼šsystemctl is-enabled postfix.service</li>
<li>æŸ¥çœ‹å·²å¯åŠ¨çš„æœåŠ¡åˆ—è¡¨ï¼šsystemctl list-unit-files|grep enabled</li>
<li>æŸ¥çœ‹å¯åŠ¨å¤±è´¥çš„æœåŠ¡åˆ—è¡¨ï¼šsystemctl --failed</li>
</ul>
<blockquote>
<p>ä½¿ç”¨å‘½ä»¤ systemctl is-enabled postfix.service å¾—åˆ°çš„å€¼å¯ä»¥æ˜¯enableã€disableæˆ–staticï¼Œè¿™é‡Œçš„ static å®ƒæ˜¯æŒ‡å¯¹åº”çš„ Unit æ–‡ä»¶ä¸­æ²¡æœ‰å®šä¹‰[Install]åŒºåŸŸï¼Œå› æ­¤æ— æ³•é…ç½®ä¸ºå¼€æœºå¯åŠ¨æœåŠ¡ã€‚</p>
</blockquote>
<p>æ›´å¤šï¼š<a href="https://linux.cn/article-5926-1.html" target="_blank" rel="noopener">https://linux.cn/article-5926-1.html</a></p>

          
        
      
    </div>
    
    
    

    <div>
          
    </div>

    

    <div>
      
    </div>


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          
       
         <div id="gitment-container"></div>
       



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/pub-images/avatar.png"
                alt="è¡Œé”‹" />
            
              <p class="site-author-name" itemprop="name">è¡Œé”‹</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">122</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">åˆ†ç±»</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">70</span>
                  <span class="site-state-item-name">æ ‡ç­¾</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/chetaofeng" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:chetaofeng@163.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-heartbeat"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

      <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=505221860&auto=0&height=66"></iframe>
    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="theme-info">
  <span>è‡ªå¤å†™å­—æ¥¼å¦‚é’æ¥¼,ä¸è®¸æ¥¼é‡Œè§ç™½å¤´</span>
</div>

<div class="copyright">&copy; 2015 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">è¡Œé”‹</span>

  
</div>

<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
 <span id="busuanzi_value_site_uv"></span>
</span>
</div>

<!--

  <div class="powered-by">ç”± <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">ä¸»é¢˜ &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>

-->




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">åšå®¢å…¨ç«™å…±121.8kå­—</span>
</div>



        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  







<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css">
        <script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script>
    
<!-- END LOCAL -->

    

    







  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'manual') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  


  <script type="text/javascript" src="/js/src/love.js"></script>
</body>
</html>
